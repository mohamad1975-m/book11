<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Ø¹Ø±Ø¨ÛŒ</title>
<style>
  
  /* Ú¯Ø§Ù„Ø±ÛŒ: ØªØµØ§ÙˆÛŒØ± ÙˆØ§Ú©Ù†Ø´â€ŒÚ¯Ø±Ø§ */
#galStrip img{
  max-height: 68vh;
  width: auto;
  border-radius: 12px;
  border: 1px solid rgba(255,255,255,.2);
  box-shadow: 0 10px 26px rgba(0,0,0,.4);
  display:block;
}
#galStrip > div{
  flex: 0 0 auto;
  display:flex;
  align-items:center;
  justify-content:center;
}

  @font-face{
    font-family:'iranyekanX';
    src:url('IRANYekanX-Light.woff2') format('woff2');
  }
  *{box-sizing:border-box}
  body {
    font-family: 'iranyekanX', sans-serif;
    margin: 0;
    padding: 0;
    color: #fff;
    background:
        radial-gradient(circle at 20% 20%, #00c6ff, transparent 40%), /* Ø¢Ø¨ÛŒ Ø±ÙˆØ´Ù† */
        radial-gradient(circle at 80% 25%, #0072ff, transparent 42%), /* Ø¢Ø¨ÛŒ Ù¾Ø±Ø±Ù†Ú¯ */
        radial-gradient(circle at 20% 80%, #00ffc8, transparent 45%), /* Ø³Ø¨Ø²Ø¢Ø¨ÛŒ */
        radial-gradient(circle at 80% 75%, #005bea, transparent 40%), /* Ø¢Ø¨ÛŒ ØªÛŒØ±Ù‡ */
        linear-gradient(180deg, #00f260 0%, #0575e6 100%); /* Ø³Ø¨Ø² Ø±ÙˆØ´Ù† Ø¨Ù‡ Ø¢Ø¨ÛŒ */
    background-attachment: fixed;
    min-height: 100vh;
    position: relative;
}
  body::before{content:"";position:fixed;inset:0;background:linear-gradient(to bottom,rgba(0,0,0,.15),rgba(0,0,0,.25));pointer-events:none;z-index:0}
  header{
    text-align:center;font-weight:800;margin:26px 0 10px;font-size:38px;
    background:linear-gradient(90deg,#60a5fa,#a78bfa,#34d399,#fbbf24,#f87171);
    background-size:400% 400%;
    -webkit-background-clip:text;-webkit-text-fill-color:transparent;
    animation:headGrad 18s ease infinite;text-shadow:0 0 10px rgba(255,255,255,.25);position:relative;z-index:1
  }
  @keyframes headGrad{0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}}

  /* toolbar */
  .toolbar{width:min(920px,95%);margin:0 auto 8px;display:flex;gap:10px;justify-content:space-between;align-items:center;z-index:2;position:relative}
  .search-box{flex:1;position:relative}
  .search-input{
    width:100%;border:none;border-radius:12px;padding:12px 40px 12px 36px;
    background:rgba(255,255,255,.14);color:#fff;font-family:inherit;outline:none;
    box-shadow:0 8px 18px rgba(0,0,0,.28);border:1px solid rgba(255,255,255,.15)
  }
  .search-input::placeholder{color:#FFFFFF}
  .search-clear{
    position:absolute;left:10px;top:50%;transform:translateY(-50%);
    width:22px;height:22px;border-radius:50%;background:rgba(255,255,255,.2);
    display:none;align-items:center;justify-content:center;cursor:pointer;color:#fff;
    box-shadow:0 4px 10px rgba(0,0,0,.3);font-weight:900
  }
  .search-icon{position:absolute;right:10px;top:50%;transform:translateY(-50%);opacity:.9}
  .sort-btn{
    border:none;border-radius:12px;padding:12px 16px;cursor:pointer;color:#fff;
    background:linear-gradient(135deg,#1C93E3,#2ea3f2);
    box-shadow:0 8px 18px rgba(28,147,227,.4);
    font-family:inherit;
  }

  .panel{
    width:min(920px,95%);margin:12px auto 20px;padding:22px 20px 26px;background:rgba(255,255,255,.12);
    border:1px solid rgba(255,255,255,.2);border-radius:18px;box-shadow:0 10px 25px rgba(0,0,0,.35);
    backdrop-filter:blur(6px);position:relative;z-index:1
  }
  .panel h2{margin:0 0 18px;font-size:22px;color:#f1f5f9;text-shadow:0 2px 8px rgba(0,0,0,.4)}
  ul.books{list-style:none;margin:0;padding:0}
  li{margin:10px 0}

  /* Ú©Ø§Ø±Øª Ú©ØªØ§Ø¨ â€“ Ú¯Ø±ÛŒØ¯ Ø¨Ø§ Ø³ØªÙˆÙ† Ø¢ÛŒÚ©ÙˆÙ†â€ŒÙ‡Ø§ Ø³Ù…Øª Ú†Ù¾ */
  .book-card{
    display:grid; grid-template-columns:134px 1fr; align-items:center;
    direction:ltr; gap:10px;text-decoration:none;color:#fff;
    background:rgba(255,255,255,.10);border:1px solid rgba(255,255,255,.15);padding:14px;border-radius:12px;
    box-shadow:0 6px 18px rgba(0,0,0,.28);transition:transform .18s ease,box-shadow .18s ease,background .18s ease;position:relative; cursor:pointer;
  }
  .book-card:hover{transform:translateY(-3px);background:rgba(255,255,255,.16);box-shadow:0 12px 28px rgba(0,0,0,.45)}
  .title{font-size:16.5px;line-height:1.6;white-space:normal;word-wrap:break-word;text-shadow:0 2px 6px rgba(0,0,0,.45);direction:rtl}
  .dcount{font-size:13px;opacity:.9}

  .left-acts{
    display:grid; grid-template-columns:46px 46px;
    grid-template-rows:38px 14px 38px 14px 38px 14px;
    gap:6px 10px; align-items:center; justify-items:center; min-width:134px;
  }
  .left-acts .icon-wrap{
    width:38px;height:38px;display:flex;align-items:center;justify-content:center;cursor:pointer;
    border-radius:10px;background:rgba(255,255,255,.12);border:1px solid rgba(255,255,255,.18);
    box-shadow:0 6px 16px rgba(0,0,0,.35); transition:transform .15s ease, background .15s ease
  }
  .left-acts .icon-wrap:hover{ transform:translateY(-2px); background:rgba(255,255,255,.16) }
  .left-acts svg{ width:22px;height:22px; fill:#fff; filter: drop-shadow(0 2px 4px rgba(0,0,0,.45));}
  .under-txt{font-size:11.5px;color:#eaeaea;direction:rtl}

  .dl{grid-column:1;grid-row:1}
  .star{grid-column:2;grid-row:1}
  .size-label{grid-column:1;grid-row:2}
  .rate-label{grid-column:2;grid-row:2}
  .share{grid-column:1;grid-row:3}
  .buy{grid-column:2;grid-row:3}
  .share-label{grid-column:1;grid-row:4}
  .comment{grid-column:2;grid-row:5}
  .cmt-label{grid-column:2;grid-row:6}

  .star-tip{
    position:absolute; right:134px; bottom:10px; background:rgba(0,0,0,.65);
    border:1px solid rgba(255,255,255,.15); color:#fff; font-size:12.5px; padding:6px 10px; border-radius:10px;
    box-shadow:0 10px 25px rgba(0,0,0,.35);
    opacity:0; transform:translateY(12px); pointer-events:none; transition:all .35s ease;
    max-width: 68%; line-height:1.8; direction:rtl
  }
  .star-tip.show{ opacity:1; transform:translateY(0) }
  .star-tip.hide{ opacity:0; transform:translateY(18px) }

  .btn-back{
    display:inline-block;margin:24px auto 10px;background:linear-gradient(135deg,#1C93E3,#2ea3f2);padding:12px 26px;color:#fff;text-decoration:none;border-radius:12px;box-shadow:0 8px 18px rgba(28,147,227,.4);transition:transform .15s ease, box-shadow .15s ease
  }
  .btn-back:hover{transform:translateY(-2px);box-shadow:0 12px 26px rgba(28,147,227,.6)}
  #counter{text-align:center;margin:12px 0 24px;font-size:15px;color:#eaeaea;text-shadow:0 2px 6px rgba(0,0,0,.45)}

  /* Ù…ÙˆØ¯Ø§Ù„â€ŒÙ‡Ø§ */
  .modal{ position:fixed; inset:0; display:none; align-items:center; justify-content:center; background: rgba(0,0,0,.5); z-index:50 }
  .modal .box{
    width:min(680px,92%); border-radius:16px; background:rgba(255,255,255,.12); border:1px solid rgba(255,255,255,.2);
    box-shadow:0 18px 40px rgba(0,0,0,.45); padding:14px 16px; backdrop-filter:blur(6px); color:#fff; position:relative; transform:scale(.95); opacity:0; transition: all .25s ease; direction:rtl
  }
  .modal.show .box{ transform:scale(1); opacity:1; }
  .modal h3{ margin:6px 0 12px; font-size:18px }
  .modal .row{ display:flex; gap:8px; justify-content:flex-end; align-items:center; margin-top:8px; flex-wrap:wrap }
  .btn{ border:none; border-radius:10px; padding:8px 16px; cursor:pointer; color:#fff; box-shadow:0 6px 16px rgba(0,0,0,.35); background:linear-gradient(135deg,#34d399,#10b981); font-family:inherit }
  .btn.gray{ background:linear-gradient(135deg,#64748b,#475569) }

  .modal-sort{ position:fixed; inset:0; display:none; align-items:center; justify-content:center; background: rgba(0,0,0,.5); z-index:60; }
  .modal-sort .box{
    width:min(520px,92%); border-radius:16px; background:rgba(255,255,255,.12); border:1px solid rgba(255,255,255,.2);
    box-shadow:0 18px 40px rgba(0,0,0,.45); padding:14px 16px; backdrop-filter:blur(6px); color:#fff; position:relative; transform:scale(.94); opacity:0; transition: all .2s ease; direction:rtl
  }
  .modal-sort.show .box{ transform:scale(1); opacity:1; }
  .sort-title{ font-size:16px; margin-bottom:10px }
  .sort-list{ list-style:none; margin:0; padding:0 }
  .sort-list li{
    margin:8px 0; padding:10px 12px; border-radius:10px; background:rgba(255,255,255,.10); border:1px solid rgba(255,255,255,.15);
    cursor:pointer; transition: all .15s ease;
  }
  .sort-list li:hover{ background: rgba(255,255,255,.16) }
  .sort-list li.active{ background: linear-gradient(135deg,#34d399,#10b981) }
  .modal-sort .row{ display:flex; gap:8px; justify-content:flex-end; margin-top:10px }

  .modal-cmt{ position:fixed; inset:0; display:none; align-items:center; justify-content:center; background: rgba(0,0,0,.55); z-index:70; }
  .modal-cmt .box{
    width:min(720px,92%); border-radius:16px; background:rgba(255,255,255,.12); border:1px solid rgba(255,255,255,.2);
    box-shadow:0 18px 40px rgba(0,0,0,.45); padding:14px 16px; backdrop-filter:blur(6px); color:#fff; position:relative; transform:translateY(20px); opacity:0; transition: all .25s ease; direction:rtl
  }
  .modal-cmt.show .box{ transform:translateY(0); opacity:1; }
  .cmt-list{ list-style:none; margin:6px 0 10px; padding:0; max-height:280px; overflow-y:auto }
  .cmt-item{ background:rgba(255,255,255,.10); border:1px solid rgba(255,255,255,.15); padding:8px 10px; border-radius:10px; margin:8px 0 }
  .cmt-head{ display:flex; align-items:center; justify-content:space-between; font-size:12px; color:#e7e7e7; margin-bottom:4px }
  .cmt-text{ font-size:14.5px; line-height:1.8; white-space:pre-wrap }
  .cmt-input{ width:100%; min-height:70px; border-radius:10px; border:none; padding:10px; resize:vertical; font-family:inherit }
  .cmt-foot{ display:flex; gap:8px; justify-content:flex-end; margin-top:8px }
  .cmt-rule{ font-size:12px; opacity:.85; margin-top:6px; text-align:center }
  .cmt-name{ width:100%; border-radius:10px; border:none; padding:10px; margin:8px 0; font-family:inherit }

  /* Ù‚Ù„Ø¨ */
  .left-acts .fav{ grid-column:1; grid-row:5; }
  .left-acts .fav-label{ grid-column:1; grid-row:6; }
  .icon-wrap.fav .heart-filled{ display:none }
  .icon-wrap.fav.active .heart-filled{ display:block }
  .icon-wrap.fav.active .heart-outline{ display:none }

  /* ÙÛŒÙ„ØªØ± Ø¨Ø±Ú†Ø³Ø¨ (Ú†ÛŒÙ¾) */
  #tagsModal .box, #tagsModal .sort-title, #tagsModal .tag-group-title, #tagsModal .chip {
    font-family: 'IRANYekanX-Light','IRANYekanX','iranyekan','IranYekan','Tahoma',sans-serif !important;
  }
  .tags-container{ display:block }
  .tag-group{ margin:10px 0 12px }
  .tag-group-title{ font-weight:800; opacity:.95; margin:6px 0 }
  .tag-group-body{ display:flex; flex-wrap:wrap; gap:8px }
  .chip{
    display:inline-flex; align-items:center; gap:6px;
    padding:6px 12px; border-radius:999px; cursor:pointer;
    background:rgba(255,255,255,.10); border:1px solid rgba(255,255,255,.15);
    transition: transform .12s ease, background .12s ease, border-color .12s ease, box-shadow .12s ease;
    user-select:none; font-size:14px; line-height:1; color:inherit;
  }
  .chip:active{ transform:scale(.98) }
  .chip.active{
    background:linear-gradient(135deg,#34d399,#10b981);
    border-color:transparent; color:#fff;
    box-shadow:0 6px 16px rgba(0,0,0,.25);
  }
  .btn-danger{ background:rgba(239,68,68,.12); border:1px solid rgba(239,68,68,.7); color:#fecaca }
  .btn-danger:hover{ filter:brightness(1.05) }
</style>
</head>
<body>
<header>Ø¹Ø±Ø¨ÛŒ ğŸ“˜</header>

<div class="toolbar">
  <div class="search-box">
    <input id="searchInput" class="search-input" type="text" placeholder="Ø¬Ø³Øªâ€ŒÙˆØ¬Ùˆ Ø¨ÛŒÙ† Ú©ØªØ§Ø¨â€ŒÙ‡Ø§"/>
    <span class="search-icon">ğŸ”</span>
    <span id="searchClear" class="search-clear">Ã—</span>
  </div>
  <button id="btnSort" class="sort-btn">Ù…Ø±ØªØ¨â€ŒØ³Ø§Ø²ÛŒ: Ù¾ÛŒØ´â€ŒÙØ±Ø¶</button>
  <button id="btnTags" class="sort-btn">Ø¨Ø±Ú†Ø³Ø¨</button>
</div>

<!-- Ø¬Ø§Ù…Ø¹ (Ù¾Ø§ÛŒÙ‡â€ŒÙ‡Ø§ÛŒ 10ØŒ 11ØŒ 12) -->
<section class="panel" data-panel="all-grades">
    <h2>Ú©ØªØ§Ø¨â€ŒÙ‡Ø§ÛŒ Ø¹Ø±Ø¨ÛŒØŒ Ø¬Ø§Ù…Ø¹ (Ù¾Ø§ÛŒÙ‡â€ŒÙ‡Ø§ÛŒ 10Ùˆ11Ùˆ12)</h2>
    <ul class="books" id="listAll">
      <!-- Ù†Ø±Ø¯Ø¨Ø§Ù… -->
      <li data-id="arabi10,11,12-nardebam">
        <div class="book-card" data-href="https://mega.nz/file/5rozzQRa#5H10mzx68oKFpc6uIdII_3qzoaG_ii6AS-t-MPeUCFk">
          <div class="left-acts">
            <div class="icon-wrap dl" title="Ø¯Ø§Ù†Ù„ÙˆØ¯"><svg viewBox="0 0 24 24"><path d="M5 20h14v-2H5v2zM11 4h2v8h3l-4 4-4-4h3V4z"/></svg></div>
            <div class="icon-wrap star" title="Ø§Ù…ØªÛŒØ§Ø²"><svg viewBox="0 0 24 24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.86L18.18 22 12 18.56 5.82 22 7 14.13 2 9.27l6.91-1.01L12 2z"/></svg></div>
            <div class="under-txt size-label" data-size>477 MB</div>
            <div class="under-txt rate-label" data-rate>3.7</div>
            <div class="icon-wrap share" title="Ø§Ø´ØªØ±Ø§Ú©â€ŒÚ¯Ø°Ø§Ø±ÛŒ"><svg viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7a3.28 3.28 0 0 0 0-1.39l7.13-4.12A2.99 2.99 0 0 0 18 7a3 3 0 1 0-3-3c0 .23.03.45.08.66L7.91 9.77A3 3 0 0 0 6 9a3 3 0 1 0 0 6c.73 0 1.4-.26 1.91-.69l7.21 4.2c-.05.2-.08.41-.08.63A3 3 0 1 0 18 16.08z"/></svg></div>
            <div class="icon-wrap buy" title="Ø®Ø±ÛŒØ¯"><svg viewBox="0 0 24 24"><path d="M7 4H5l-1 2H0v2h2l3.6 7.59c-.35.6-.6 1.28-.6 2.01A3.5 3.5 0 0 0 8.5 21 3.5 3.5 0 0 0 12 18.5h2A3.5 3.5 0 0 0 17.5 21 3.5 3.5 0 0 0 21 17.5c0-1.23-.66-2.29-1.64-2.86L21 7H7V4zm0 4h12l-1.5 6.5H9L7 8z"/></svg></div>
            <div class="under-txt share-label"></div>
            <div class="icon-wrap comment" title="Ú©Ø§Ù…Ù†Øªâ€ŒÙ‡Ø§"><svg viewBox="0 0 24 24"><path d="M20 2H4a2 2 0 0 0-2 2v18l4-4h14a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2z"/></svg></div>
            <div class="under-txt cmt-label" data-cmtcount>Û°</div>
            <div class="icon-wrap fav" title="Ø¹Ù„Ø§Ù‚Ù‡â€ŒÙ…Ù†Ø¯ÛŒ">
              <svg class="heart-outline" viewBox="0 0 24 24"><path d="M12.1 8.64l-.1.1-.11-.11C10.14 6.9 7.1 7 5.5 8.6a4.3 4.3 0 0 0 0 6.1L12 21l6.5-6.3a4.3 4.3 0 0 0 0-6.1c-1.6-1.6-4.6-1.7-6.4.04z" fill="none" stroke="white" stroke-width="1.6"/></svg>
              <svg class="heart-filled" viewBox="0 0 24 24"><path d="M12.1 21.35l-1.1-1.01C5.14 15.28 2 12.36 2 8.99 2 6.42 4.42 4 7 4c1.54 0 3.04.73 4 1.87C11.96 4.73 13.46 4 15 4c2.58 0 5 2.42 5 4.99 0 3.37-3.14 6.29-8.9 11.35z"/></svg>
            </div>
            <div class="under-txt fav-label" data-favcount>Û°</div>
          </div>
          <span class="title">Ù†Ø±Ø¯Ø¨Ø§Ù… â€“ Ø®ÛŒÙ„ÛŒâ€ŒØ³Ø¨Ø² <span class="dcount" data-dlc>(Û° Ø¯Ø§Ù†Ù„ÙˆØ¯)</span></span>
          <div class="star-tip"></div>
        </div>
      </li>
  
      <!-- Ù„Ù‚Ù…Ù‡ -->
      <li data-id="arabi10,11,12-loghme">
        <div class="book-card" data-href="https://mega.nz/file/l35VXTZJ#oDFT55PEbHF4fUfWjPdi8V4H1xLyu_2eqS2ob42Xtls">
          <div class="left-acts">
            <div class="icon-wrap dl" title="Ø¯Ø§Ù†Ù„ÙˆØ¯"><svg viewBox="0 0 24 24"><path d="M5 20h14v-2H5v2zM11 4h2v8h3l-4 4-4-4h3V4z"/></svg></div>
            <div class="icon-wrap star" title="Ø§Ù…ØªÛŒØ§Ø²"><svg viewBox="0 0 24 24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.86L18.18 22 12 18.56 5.82 22 7 14.13 2 9.27l6.91-1.01L12 2z"/></svg></div>
            <div class="under-txt size-label" data-size>152 MB</div>
            <div class="under-txt rate-label" data-rate>4.6</div>
            <div class="icon-wrap share" title="Ø§Ø´ØªØ±Ø§Ú©â€ŒÚ¯Ø°Ø§Ø±ÛŒ"><svg viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7a3.28 3.28 0 0 0 0-1.39l7.13-4.12A2.99 2.99 0 0 0 18 7a3 3 0 1 0-3-3c0 .23.03.45.08.66L7.91 9.77A3 3 0 0 0 6 9a3 3 0 1 0 0 6c.73 0 1.4-.26 1.91-.69l7.21 4.2c-.05.2-.08.41-.08.63A3 3 0 1 0 18 16.08z"/></svg></div>
            <div class="icon-wrap buy" title="Ø®Ø±ÛŒØ¯"><svg viewBox="0 0 24 24"><path d="M7 4H5l-1 2H0v2h2l3.6 7.59c-.35.6-.6 1.28-.6 2.01A3.5 3.5 0 0 0 8.5 21 3.5 3.5 0 0 0 12 18.5h2A3.5 3.5 0 0 0 17.5 21 3.5 3.5 0 0 0 21 17.5c0-1.23-.66-2.29-1.64-2.86L21 7H7V4zm0 4h12l-1.5 6.5H9L7 8z"/></svg></div>
            <div class="under-txt share-label"></div>
            <div class="icon-wrap comment" title="Ú©Ø§Ù…Ù†Øªâ€ŒÙ‡Ø§"><svg viewBox="0 0 24 24"><path d="M20 2H4a2 2 0 0 0-2 2v18l4-4h14a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2z"/></svg></div>
            <div class="under-txt cmt-label" data-cmtcount>Û°</div>
            <div class="icon-wrap fav" title="Ø¹Ù„Ø§Ù‚Ù‡â€ŒÙ…Ù†Ø¯ÛŒ">
              <svg class="heart-outline" viewBox="0 0 24 24"><path d="M12.1 8.64l-.1.1-.11-.11C10.14 6.9 7.1 7 5.5 8.6a4.3 4.3 0 0 0 0 6.1L12 21l6.5-6.3a4.3 4.3 0 0 0 0-6.1c-1.6-1.6-4.6-1.7-6.4.04z" fill="none" stroke="white" stroke-width="1.6"/></svg>
              <svg class="heart-filled" viewBox="0 0 24 24"><path d="M12.1 21.35l-1.1-1.01C5.14 15.28 2 12.36 2 8.99 2 6.42 4.42 4 7 4c1.54 0 3.04.73 4 1.87C11.96 4.73 13.46 4 15 4c2.58 0 5 2.42 5 4.99 0 3.37-3.14 6.29-8.9 11.35z"/></svg>
            </div>
            <div class="under-txt fav-label" data-favcount>Û°</div>
          </div>
          <span class="title">Ù„Ù‚Ù…Ù‡ â€“ Ù…Ù‡Ø± Ùˆ Ù…Ø§Ù‡ <span class="dcount" data-dlc>(Û° Ø¯Ø§Ù†Ù„ÙˆØ¯)</span></span>
          <div class="star-tip"></div>
        </div>
      </li>
    </ul>
  </section>
  
<!-- Ù¾Ø§ÛŒÙ‡ ÛŒØ§Ø²Ø¯Ù‡Ù… -->
<section class="panel" data-panel="11">
    <h2>Ú©ØªØ§Ø¨â€ŒÙ‡Ø§ÛŒ Ø¹Ø±Ø¨ÛŒØŒ Ù¾Ø§ÛŒÙ‡ ÛŒØ§Ø²Ø¯Ù‡Ù…</h2>
    <ul class="books" id="list11">
      <!-- Ù…Ø§Ø¬Ø±Ø§ÛŒ Ø¨ÛŒØ³Øª ÛŒØ§Ø²Ø¯Ù‡Ù… -->
      <li data-id="arabi11-majara20">
        <div class="book-card" data-href="https://mega.nz/file/V7xWgbjC#tSy--rZ8eONsTFW0VdxmkRxviSYqcjpfg_hqAVlnm3o">
          <div class="left-acts">
            <div class="icon-wrap dl" title="Ø¯Ø§Ù†Ù„ÙˆØ¯"><svg viewBox="0 0 24 24"><path d="M5 20h14v-2H5v2zM11 4h2v8h3l-4 4-4-4h3V4z"/></svg></div>
            <div class="icon-wrap star" title="Ø§Ù…ØªÛŒØ§Ø²"><svg viewBox="0 0 24 24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.86L18.18 22 12 18.56 5.82 22 7 14.13 2 9.27l6.91-1.01L12 2z"/></svg></div>
            <div class="under-txt size-label" data-size>84 MB</div>
            <div class="under-txt rate-label" data-rate>4.7</div>
            <div class="icon-wrap share" title="Ø§Ø´ØªØ±Ø§Ú©â€ŒÚ¯Ø°Ø§Ø±ÛŒ"><svg viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7a3.28 3.28 0 0 0 0-1.39l7.13-4.12A2.99 2.99 0 0 0 18 7a3 3 0 1 0-3-3c0 .23.03.45.08.66L7.91 9.77A3 3 0 0 0 6 9a3 3 0 1 0 0 6c.73 0 1.4-.26 1.91-.69l7.21 4.2c-.05.2-.08.41-.08.63A3 3 0 1 0 18 16.08z"/></svg></div>
            <div class="icon-wrap buy" title="Ø®Ø±ÛŒØ¯"><svg viewBox="0 0 24 24"><path d="M7 4H5l-1 2H0v2h2l3.6 7.59c-.35.6-.6 1.28-.6 2.01A3.5 3.5 0 0 0 8.5 21 3.5 3.5 0 0 0 12 18.5h2A3.5 3.5 0 0 0 17.5 21 3.5 3.5 0 0 0 21 17.5c0-1.23-.66-2.29-1.64-2.86L21 7H7V4zm0 4h12l-1.5 6.5H9L7 8z"/></svg></div>
            <div class="under-txt share-label"></div>
            <div class="icon-wrap comment" title="Ú©Ø§Ù…Ù†Øªâ€ŒÙ‡Ø§"><svg viewBox="0 0 24 24"><path d="M20 2H4a2 2 0 0 0-2 2v18l4-4h14a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2z"/></svg></div>
            <div class="under-txt cmt-label" data-cmtcount>Û°</div>
            <div class="icon-wrap fav" title="Ø¹Ù„Ø§Ù‚Ù‡â€ŒÙ…Ù†Ø¯ÛŒ">
              <svg class="heart-outline" viewBox="0 0 24 24"><path d="M12.1 8.64l-.1.1-.11-.11C10.14 6.9 7.1 7 5.5 8.6a4.3 4.3 0 0 0 0 6.1L12 21l6.5-6.3a4.3 4.3 0 0 0 0-6.1c-1.6-1.6-4.6-1.7-6.4.04z" fill="none" stroke="white" stroke-width="1.6"/></svg>
              <svg class="heart-filled" viewBox="0 0 24 24"><path d="M12.1 21.35l-1.1-1.01C5.14 15.28 2 12.36 2 8.99 2 6.42 4.42 4 7 4c1.54 0 3.04.73 4 1.87C11.96 4.73 13.46 4 15 4c2.58 0 5 2.42 5 4.99 0 3.37-3.14 6.29-8.9 11.35z"/></svg>
            </div>
            <div class="under-txt fav-label" data-favcount>Û°</div>
          </div>
          <span class="title">Ù…Ø§Ø¬Ø±Ø§ÛŒ Ø¨ÛŒØ³Øª â€“ Ø®ÛŒÙ„ÛŒâ€ŒØ³Ø¨Ø² <span class="dcount" data-dlc>(Û° Ø¯Ø§Ù†Ù„ÙˆØ¯)</span></span>
          <div class="star-tip"></div>
        </div>
      </li>
  
      <!-- Ø´Ø¨ Ø§Ù…ØªØ­Ø§Ù† ÛŒØ§Ø²Ø¯Ù‡Ù… -->
      <li data-id="arabi11-shab">
        <div class="book-card" data-href="https://mega.nz/file/crpwCKID#ySQDhJCBl411hhNAAvkKih56fjZuSm1gYfsdteK3R8g">
          <div class="left-acts">
            <div class="icon-wrap dl" title="Ø¯Ø§Ù†Ù„ÙˆØ¯"><svg viewBox="0 0 24 24"><path d="M5 20h14v-2H5v2zM11 4h2v8h3l-4 4-4-4h3V4z"/></svg></div>
            <div class="icon-wrap star" title="Ø§Ù…ØªÛŒØ§Ø²"><svg viewBox="0 0 24 24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.86L18.18 22 12 18.56 5.82 22 7 14.13 2 9.27l6.91-1.01L12 2z"/></svg></div>
            <div class="under-txt size-label" data-size>152 MB</div>
            <div class="under-txt rate-label" data-rate>4.6</div>
            <div class="icon-wrap share" title="Ø§Ø´ØªØ±Ø§Ú©â€ŒÚ¯Ø°Ø§Ø±ÛŒ"><svg viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7a3.28 3.28 0 0 0 0-1.39l7.13-4.12A2.99 2.99 0 0 0 18 7a3 3 0 1 0-3-3c0 .23.03.45.08.66L7.91 9.77A3 3 0 0 0 6 9a3 3 0 1 0 0 6c.73 0 1.4-.26 1.91-.69l7.21 4.2c-.05.2-.08.41-.08.63A3 3 0 1 0 18 16.08z"/></svg></div>
            <div class="icon-wrap buy" title="Ø®Ø±ÛŒØ¯"><svg viewBox="0 0 24 24"><path d="M7 4H5l-1 2H0v2h2l3.6 7.59c-.35.6-.6 1.28-.6 2.01A3.5 3.5 0 0 0 8.5 21 3.5 3.5 0 0 0 12 18.5h2A3.5 3.5 0 0 0 17.5 21 3.5 3.5 0 0 0 21 17.5c0-1.23-.66-2.29-1.64-2.86L21 7H7V4zm0 4h12l-1.5 6.5H9L7 8z"/></svg></div>
            <div class="under-txt share-label"></div>
            <div class="icon-wrap comment" title="Ú©Ø§Ù…Ù†Øªâ€ŒÙ‡Ø§"><svg viewBox="0 0 24 24"><path d="M20 2H4a2 2 0 0 0-2 2v18l4-4h14a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2z"/></svg></div>
            <div class="under-txt cmt-label" data-cmtcount>Û°</div>
            <div class="icon-wrap fav" title="Ø¹Ù„Ø§Ù‚Ù‡â€ŒÙ…Ù†Ø¯ÛŒ">
              <svg class="heart-outline" viewBox="0 0 24 24"><path d="M12.1 8.64l-.1.1-.11-.11C10.14 6.9 7.1 7 5.5 8.6a4.3 4.3 0 0 0 0 6.1L12 21l6.5-6.3a4.3 4.3 0 0 0 0-6.1c-1.6-1.6-4.6-1.7-6.4.04z" fill="none" stroke="white" stroke-width="1.6"/></svg>
              <svg class="heart-filled" viewBox="0 0 24 24"><path d="M12.1 21.35l-1.1-1.01C5.14 15.28 2 12.36 2 8.99 2 6.42 4.42 4 7 4c1.54 0 3.04.73 4 1.87C11.96 4.73 13.46 4 15 4c2.58 0 5 2.42 5 4.99 0 3.37-3.14 6.29-8.9 11.35z"/></svg>            </div>
            <div class="under-txt fav-label" data-favcount>Û°</div>
          </div>
          <span class="title">Ø´Ø¨ Ø§Ù…ØªØ­Ø§Ù† â€“ Ø®ÛŒÙ„ÛŒâ€ŒØ³Ø¨Ø² <span class="dcount" data-dlc>(Û° Ø¯Ø§Ù†Ù„ÙˆØ¯)</span></span>
          <div class="star-tip"></div>
        </div>
      </li>
    </ul>
  </section>
  
<!-- Ù¾Ø§ÛŒÙ‡ Ø¯Ù‡Ù… -->
<section class="panel" data-panel="10">
    <h2>Ú©ØªØ§Ø¨â€ŒÙ‡Ø§ÛŒ Ø¹Ø±Ø¨ÛŒØŒ Ù¾Ø§ÛŒÙ‡ Ø¯Ù‡Ù…</h2>
    <ul class="books" id="list10">
      <!-- Ù…Ø§Ø¬Ø±Ø§ÛŒ Ø¨ÛŒØ³Øª Ø¯Ù‡Ù… -->
      <li data-id="arabi10-majara20">
        <div class="book-card" data-href="https://s33.picofile.com/d/8484567834/e89dee5a-ac47-46cd-aa90-61a28ec56851/_kotob_konkoria_arabi_10_ensani_majara20_1404_.pdf">
          <div class="left-acts">
            <div class="icon-wrap dl" title="Ø¯Ø§Ù†Ù„ÙˆØ¯"><svg viewBox="0 0 24 24"><path d="M5 20h14v-2H5v2zM11 4h2v8h3l-4 4-4-4h3V4z"/></svg></div>
            <div class="icon-wrap star" title="Ø§Ù…ØªÛŒØ§Ø²"><svg viewBox="0 0 24 24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.86L18.18 22 12 18.56 5.82 22 7 14.13 2 9.27l6.91-1.01L12 2z"/></svg></div>
            <div class="under-txt size-label" data-size>152 MB</div>
            <div class="under-txt rate-label" data-rate>4.6</div>
            <div class="icon-wrap share" title="Ø§Ø´ØªØ±Ø§Ú©â€ŒÚ¯Ø°Ø§Ø±ÛŒ"><svg viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7a3.28 3.28 0 0 0 0-1.39l7.13-4.12A2.99 2.99 0 0 0 18 7a3 3 0 1 0-3-3c0 .23.03.45.08.66L7.91 9.77A3 3 0 0 0 6 9a3 3 0 1 0 0 6c.73 0 1.4-.26 1.91-.69l7.21 4.2c-.05.2-.08.41-.08.63A3 3 0 1 0 18 16.08z"/></svg></div>
            <div class="icon-wrap buy" title="Ø®Ø±ÛŒØ¯"><svg viewBox="0 0 24 24"><path d="M7 4H5l-1 2H0v2h2l3.6 7.59c-.35.6-.6 1.28-.6 2.01A3.5 3.5 0 0 0 8.5 21 3.5 3.5 0 0 0 12 18.5h2A3.5 3.5 0 0 0 17.5 21 3.5 3.5 0 0 0 21 17.5c0-1.23-.66-2.29-1.64-2.86L21 7H7V4zm0 4h12l-1.5 6.5H9L7 8z"/></svg></div>
            <div class="under-txt share-label"></div>
            <div class="icon-wrap comment" title="Ú©Ø§Ù…Ù†Øªâ€ŒÙ‡Ø§"><svg viewBox="0 0 24 24"><path d="M20 2H4a2 2 0 0 0-2 2v18l4-4h14a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2z"/></svg></div>
            <div class="under-txt cmt-label" data-cmtcount>Û°</div>
            <div class="icon-wrap fav" title="Ø¹Ù„Ø§Ù‚Ù‡â€ŒÙ…Ù†Ø¯ÛŒ">
              <svg class="heart-outline" viewBox="0 0 24 24"><path d="M12.1 8.64l-.1.1-.11-.11C10.14 6.9 7.1 7 5.5 8.6a4.3 4.3 0 0 0 0 6.1L12 21l6.5-6.3a4.3 4.3 0 0 0 0-6.1c-1.6-1.6-4.6-1.7-6.4.04z" fill="none" stroke="white" stroke-width="1.6"/></svg>
              <svg class="heart-filled" viewBox="0 0 24 24"><path d="M12.1 21.35l-1.1-1.01C5.14 15.28 2 12.36 2 8.99 2 6.42 4.42 4 7 4c1.54 0 3.04.73 4 1.87C11.96 4.73 13.46 4 15 4c2.58 0 5 2.42 5 4.99 0 3.37-3.14 6.29-8.9 11.35z"/></svg>            </div>
            <div class="under-txt fav-label" data-favcount>Û°</div>
          </div>
          <span class="title">Ù…Ø§Ø¬Ø±Ø§ÛŒ Ø¨ÛŒØ³Øª â€“ Ø®ÛŒÙ„ÛŒâ€ŒØ³Ø¨Ø² <span class="dcount" data-dlc>(Û° Ø¯Ø§Ù†Ù„ÙˆØ¯)</span></span>
          <div class="star-tip"></div>
        </div>
      </li>
      <!-- Ù†Ù…Ø§ÛŒØ´ ØµÙØ­Ø§Øª Ú©ØªØ§Ø¨ (Ú¯Ø§Ù„Ø±ÛŒ ØªØµØ§ÙˆÛŒØ±) -->
<li data-id="arabi10-gallery">
  <div class="book-card" data-gallery="arabi10-lessons">
    <div class="left-acts">
      <!-- ÙÙ‚Ø· Ø§ÛŒÙ† Ø¢ÛŒÚ©Ù† Ú¯Ø§Ù„Ø±ÛŒ Ø±Ùˆ Ø¨Ø§Ø² Ù…ÛŒâ€ŒÚ©Ù†Ø¯ -->
      <div class="icon-wrap view" title="Ù†Ù…Ø§ÛŒØ´ (Ú¯Ø§Ù„Ø±ÛŒ)">
        <!-- Ø¢ÛŒÚ©Ù† Ú†Ø´Ù… -->
        <svg viewBox="0 0 24 24">
          <path d="M12 5C7 5 2.73 8.11 1 12c1.73 3.89 6 7 11 7s9.27-3.11 11-7c-1.73-3.89-6-7-11-7zm0 12a5 5 0 1 1 0-10 5 5 0 0 1 0 10zm0-8a3 3 0 1 0 .001 6.001A3 3 0 0 0 12 9z"/>
        </svg>
      </div>

      <div class="icon-wrap star" title="Ø§Ù…ØªÛŒØ§Ø²">
        <svg viewBox="0 0 24 24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.86L18.18 22 12 18.56 5.82 22 7 14.13 2 9.27l6.91-1.01L12 2z"/></svg>
      </div>
      <div class="under-txt size-label" data-size>â€”</div>
      <div class="under-txt rate-label" data-rate>â€”</div>

      <div class="icon-wrap share" title="Ø§Ø´ØªØ±Ø§Ú©â€ŒÚ¯Ø°Ø§Ø±ÛŒ">
        <svg viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7a3.28 3.28 0 0 0 0-1.39l7.13-4.12A2.99 2.99 0 0 0 18 7a3 3 0 1 0-3-3c0 .23.03.45.08.66L7.91 9.77A3 3 0 0 0 6 9a3 3 0 1 0 0 6c.73 0 1.4-.26 1.91-.69l7.21 4.2c-.05.2-.08.41-.08.63A3 3 0 1 0 18 16.08z"/></svg>
      </div>

      <!-- Ø®Ø±ÛŒØ¯: ØºÛŒØ±ÙØ¹Ø§Ù„ (Ù¾ÛŒØ§Ù… Toast) -->
      <div class="icon-wrap buy" title="Ø®Ø±ÛŒØ¯ (ØºÛŒØ±ÙØ¹Ø§Ù„)">
        <svg viewBox="0 0 24 24"><path d="M7 4H5l-1 2H0v2h2l3.6 7.59c-.35.6-.6 1.28-.6 2.01A3.5 3.5 0 0 0 8.5 21 3.5 3.5 0 0 0 12 18.5h2A3.5 3.5 0 0 0 17.5 21 3.5 3.5 0 0 0 21 17.5c0-1.23-.66-2.29-1.64-2.86L21 7H7V4zm0 4h12l-1.5 6.5H9L7 8z"/></svg>
      </div>

      <div class="under-txt share-label"></div>
      <div class="icon-wrap comment" title="Ú©Ø§Ù…Ù†Øªâ€ŒÙ‡Ø§"><svg viewBox="0 0 24 24"><path d="M20 2H4a2 2 0 0 0-2 2v18l4-4h14a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2z"/></svg></div>
      <div class="under-txt cmt-label" data-cmtcount>Û°</div>
      <div class="icon-wrap fav" title="Ø¹Ù„Ø§Ù‚Ù‡â€ŒÙ…Ù†Ø¯ÛŒ">
        <svg class="heart-outline" viewBox="0 0 24 24"><path d="M12.1 8.64l-.1.1-.11-.11C10.14 6.9 7.1 7 5.5 8.6a4.3 4.3 0 0 0 0 6.1L12 21l6.5-6.3a4.3 4.3 0 0 0 0-6.1c-1.6-1.6-4.6-1.7-6.4.04z" fill="none" stroke="white" stroke-width="1.6"/></svg>
        <svg class="heart-filled" viewBox="0 0 24 24"><path d="M12.1 21.35l-1.1-1.01C5.14 15.28 2 12.36 2 8.99 2 6.42 4.42 4 7 4c1.54 0 3.04.73 4 1.87C11.96 4.73 13.46 4 15 4c2.58 0 5 2.42 5 4.99 0 3.37-3.14 6.29-8.9 11.35z"/></svg>
      </div>
      <div class="under-txt fav-label" data-favcount>Û°</div>
    </div>

    <span class="title">Ù†Ú©Ø§ØªÛŒ Ú©Ù‡ Ø®ÙˆØ¯Ù… Ù†ÙˆØ´ØªÙ…<span class="dcount" 
    <div class="star-tip"></div>
  </div>
</li>


    </ul>
  </section>
  
  

<div style="text-align:center">
  <a class="btn-back" href="index.html">Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ù…Ù†ÙˆÛŒ Ø§ØµÙ„ÛŒ</a>
</div>

<div id="counter"><span id="visit-count">Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ...</span></div>

<!-- Ù…ÙˆØ¯Ø§Ù„ Ù¾ÛŒØ´â€ŒÙ†Ù…Ø§ÛŒØ´ -->
<div class="modal" id="previewModal">
  <div class="box">
    <h3 id="pvTitle">Ù¾ÛŒØ´â€ŒÙ†Ù…Ø§ÛŒØ´</h3>
    <div id="pvBody" style="line-height:1.9;font-size:14.5px;opacity:.95"></div>
    <div class="row"><button id="pvClose" class="btn gray">Ø¨Ø³ØªÙ†</button></div>
  </div>
</div>

<!-- Ù…ÙˆØ¯Ø§Ù„ Ù…Ø±ØªØ¨â€ŒØ³Ø§Ø²ÛŒ -->
<div class="modal-sort" id="sortModal">
  <div class="box">
    <div class="sort-title">Ù…Ø±ØªØ¨â€ŒØ³Ø§Ø²ÛŒ Ø¨Ø± Ø§Ø³Ø§Ø³</div>
    <ul class="sort-list" id="sortList">
      <li data-sort="default" class="active">Ù¾ÛŒØ´â€ŒÙØ±Ø¶</li>
      <li data-sort="rate">Ø¨ÛŒØ´ØªØ±ÛŒÙ† Ø§Ù…ØªÛŒØ§Ø²</li>
      <li data-sort="downloads">Ø¨ÛŒØ´ØªØ±ÛŒÙ† Ø¯Ø§Ù†Ù„ÙˆØ¯</li>
      <li data-sort="likes">Ø¨ÛŒØ´ØªØ±ÛŒÙ† Ù„Ø§ÛŒÚ©</li>
      <li data-sort="size">Ú©Ù…â€ŒØ­Ø¬Ù…â€ŒØªØ±ÛŒÙ†</li>
    </ul>
    <div class="row"><button class="btn gray" id="btnSortClose">Ø¨Ø³ØªÙ†</button></div>
  </div>
</div>

<!-- Ù…ÙˆØ¯Ø§Ù„ Ú©Ø§Ù…Ù†Øªâ€ŒÙ‡Ø§ -->
<div class="modal-cmt" id="cmtModal">
  <div class="box">
    <h3 id="cmtTitle">Ú©Ø§Ù…Ù†Øªâ€ŒÙ‡Ø§</h3>
    <ul class="cmt-list" id="cmtList"></ul>
    <input class="cmt-name" id="cmtName" maxlength="40" placeholder="Ù†Ø§Ù… Ù…Ø³ØªØ¹Ø§Ø± (Ø§Ø®ØªÛŒØ§Ø±ÛŒ)" />
    <textarea class="cmt-input" id="cmtInput" placeholder="Ú©Ø§Ù…Ù†Øª Ø¬Ø¯ÛŒØ¯"></textarea>
    <div class="cmt-foot">
      <button class="btn gray" id="cmtClose">Ø¨Ø³ØªÙ†</button>
      <button class="btn" id="cmtSend">Ø§Ø±Ø³Ø§Ù„ Ú©Ø§Ù…Ù†Øª</button>
    </div>
    <div class="cmt-rule">Ø§Ø±Ø³Ø§Ù„ Ù†Ø¸Ø± Ø¨Ø±Ø§ÛŒ Ù‡Ù…Ù‡ Ú©Ø§Ø±Ø¨Ø±Ø§Ù† Ø¢Ø²Ø§Ø¯ Ø§Ø³Øª.</div>
  </div>
</div>

<!-- Ù…ÙˆØ¯Ø§Ù„ Ú¯Ø§Ù„Ø±ÛŒ ØªØµØ§ÙˆÛŒØ± -->
<div class="modal" id="galleryModal" style="display:none">
  <div class="box" style="padding:12px">
    <h3 id="galTitle" style="margin-bottom:10px">Ú¯Ø§Ù„Ø±ÛŒ ØªØµØ§ÙˆÛŒØ±</h3>
    <div id="galWrap" style="position:relative; overflow:hidden">
      <button id="galPrev" class="btn gray" style="position:absolute; top:50%; right:8px; transform:translateY(-50%); z-index:2">Ù‚Ø¨Ù„ÛŒ</button>
      <div id="galStrip" style="display:flex; gap:6px; overflow-x:auto; scroll-behavior:smooth; padding:2px">
        <!-- ØªØµØ§ÙˆÛŒØ± Ø§ÛŒÙ†Ø¬Ø§ ØªØ²Ø±ÛŒÙ‚ Ù…ÛŒâ€ŒØ´Ù† -->
      </div>
      <button id="galNext" class="btn gray" style="position:absolute; top:50%; left:8px; transform:translateY(-50%); z-index:2">Ø¨Ø¹Ø¯ÛŒ</button>
    </div>
    <div class="row" style="margin-top:8px">
      <button id="galClose" class="btn gray">Ø¨Ø³ØªÙ†</button>
    </div>
  </div>
</div>

<!-- Ù…ÙˆØ¯Ø§Ù„ ÙÛŒÙ„ØªØ± Ø¨Ø±Ú†Ø³Ø¨â€ŒÙ‡Ø§ -->
<div class="modal-sort" id="tagsModal" style="display:none">
  <div class="box">
    <div class="sort-title">ÙÛŒÙ„ØªØ± Ø¨Ø± Ø§Ø³Ø§Ø³ Ø¨Ø±Ú†Ø³Ø¨â€ŒÙ‡Ø§</div>
    <div id="tagsContainer" class="tags-container"></div>
    <div class="row" style="gap:8px; flex-wrap:wrap">
      <button class="btn btn-danger" type="button" id="btnTagsDeleteAll">Ø­Ø°Ù Ù‡Ù…Ù‡â€ŒÛŒ ÙÛŒÙ„ØªØ±Ù‡Ø§</button>
      <button class="btn gray" type="button" id="btnTagsCancel">Ù„ØºÙˆ</button>
      <button class="btn" type="button" id="btnTagsApply">Ø§Ø¹Ù…Ø§Ù„</button>
    </div>
  </div>
</div>

<script>
/* ---- Ú©Ù…Ú©â€ŒØªØ§Ø¨Ø¹ Ø§Ø¹Ø¯Ø§Ø¯ ÙØ§Ø±Ø³ÛŒ ---- */
const faDigits = n => (typeof n==='number'? n.toLocaleString('fa-IR') : (''+n).replace(/\d/g,d=>'Û°Û±Û²Û³Û´ÛµÛ¶Û·Û¸Û¹'[d]));
const faRate = v => (v==null? 'ØŸ' : (''+v).replace(/\./g,'Ù«').replace(/\d/g,d=>'Û°Û±Û²Û³Û´ÛµÛ¶Û·Û¸Û¹'[d]));

/* ---- Ø´Ù…Ø§Ø±Ù†Ø¯Ù‡ Ø¨Ø§Ø²Ø¯ÛŒØ¯ ØµÙØ­Ù‡ ---- */
async function loadVisits(){
  const slug='arabi';
  try{
    const r=await fetch(`/api/visits?slug=${encodeURIComponent(slug)}`,{cache:'no-store'});
    const d=await r.json();
    if(!r.ok||typeof d.value!=='number')throw 0;
    document.getElementById('visit-count').textContent=`Ø¨Ø§Ø²Ø¯ÛŒØ¯ Ø§ÛŒÙ† ØµÙØ­Ù‡: ${faDigits(d.value)}`;
    await fetch(`/api/log?slug=${encodeURIComponent(slug)}`,{
      method:'POST',headers:{'Content-Type':'application/json'},
      body:JSON.stringify({ua:navigator.userAgent})
    });
  }catch{
    document.getElementById('visit-count').textContent='Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª Ø´Ù…Ø§Ø±Ù†Ø¯Ù‡';
  }
}
loadVisits();

/* ---- Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø«Ø§Ø¨Øª Ù‡Ø± Ú©ØªØ§Ø¨ ---- */
const bookMeta = {
  'arabi11-majara20': {
    size: '84 MB', rate: 4.7, votes: 11,
    buy: 'https://www.digikala.com/product/dkp-16774485/Ú©ØªØ§Ø¨-Ù…Ø§Ø¬Ø±Ø§ÙŠ-Ø¨ÙŠØ³Øª-Ø¹Ø±Ø¨ÙŠ-ÙŠØ§Ø²Ø¯Ù‡Ù…-Ø§Ù†Ø³Ø§Ù†ÙŠ-Ø§Ø«Ø±-Ø¹Ù„ÙŠ-Ø¬Ø¹ÙØ±ÙŠ-Ø§Ù†ØªØ´Ø§Ø±Ø§Øª-Ø®ÛŒÙ„ÛŒ-Ø³Ø¨Ø²/',
    publisher: 'Ø®ÛŒÙ„ÛŒâ€ŒØ³Ø¨Ø²',
    tags: ['ØªØ³Øª','Ø¯Ø±Ø³Ù†Ø§Ù…Ù‡','Ù¾Ø§ÛŒÙ‡ ÛŒØ§Ø²Ø¯Ù‡Ù…','ØªØ´Ø±ÛŒØ­ÛŒ','Ø§Ù…ØªØ­Ø§Ù† Ù†Ù‡Ø§ÛŒÛŒ','Ø®ÛŒÙ„ÛŒâ€ŒØ³Ø¨Ø²','Ù…Ø§Ø¬Ø±Ø§ÛŒ Ø¨ÛŒØ³Øª'],
    downloads: 0
  },
  'arabi11-shab': {
    size: '30 MB', rate: 4.5, votes: 44,
    buy: 'https://www.digikala.com/product/dkp-820953/Ú©ØªØ§Ø¨-Ø´Ø¨-Ø§Ù…ØªØ­Ø§Ù†-Ø¹Ø±Ø¨ÛŒ-Ù¾Ø§ÛŒÙ‡-ÛŒØ§Ø²Ø¯Ù‡Ù…-Ø§Ù†Ø³Ø§Ù†ÛŒ-Ø§Ø«Ø±-Ø¨Ù‡Ø±ÙˆØ²-Ø­ÛŒØ¯Ø±Ø¨Ú©ÛŒ/',
    publisher: 'Ø®ÛŒÙ„ÛŒâ€ŒØ³Ø¨Ø²',
    tags: ['ØªØ³Øª','Ø¯Ø±Ø³Ù†Ø§Ù…Ù‡','Ù¾Ø§ÛŒÙ‡ ÛŒØ§Ø²Ø¯Ù‡Ù…','Ø®ÛŒÙ„ÛŒâ€ŒØ³Ø¨Ø²','Ø´Ø¨ Ø§Ù…ØªØ­Ø§Ù†'],
    downloads: 0
  },
  'arabi10-majara20': {
    size: '103 MB', rate: 5, votes: 2,
    buy: 'https://www.digikala.com/product/dkp-17071915/Ú©ØªØ§Ø¨-Ù…Ø§Ø¬Ø±Ø§ÛŒ-Ø¨ÛŒØ³Øª-Ø¹Ø±Ø¨ÛŒ-Ø¯Ù‡Ù…-Ø§Ù†Ø³Ø§Ù†ÛŒ-Ø§Ø«Ø±-Ø³ÛŒØ¯-Ù…Ø­Ù…Ø¯Ø¹Ù„ÛŒ-Ø¬Ù†Ø§Ù†ÛŒ-Ùˆ-Ø¹Ù„ÛŒ-Ø¬Ø¹ÙØ±ÛŒ-Ù†Ø¯ÙˆØ´Ù†-Ø§Ù†ØªØ´Ø§Ø±Ø§Øª-Ø®ÛŒÙ„ÛŒ-Ø³Ø¨Ø²/',
    publisher: 'Ø®ÛŒÙ„ÛŒâ€ŒØ³Ø¨Ø²',
    tags: ['ØªØ³Øª','Ø¯Ø±Ø³Ù†Ø§Ù…Ù‡','Ù¾Ø§ÛŒÙ‡ Ø¯Ù‡Ù…','ØªØ´Ø±ÛŒØ­ÛŒ','Ø§Ù…ØªØ­Ø§Ù† Ù†Ù‡Ø§ÛŒÛŒ','Ø®ÛŒÙ„ÛŒâ€ŒØ³Ø¨Ø²','Ù…Ø§Ø¬Ø±Ø§ÛŒ Ø¨ÛŒØ³Øª'],
    downloads: 0
  },
  'arabi10,11,12-nardebam': {
    size: '477 MB', rate: 3.7, votes: 3,
    buy: 'https://www.digikala.com/product/dkp-12953270/Ú©ØªØ§Ø¨-Ù†Ø±Ø¯Ø¨Ø§Ù…-Ø¹Ø±Ø¨ÛŒ-Ø¬Ø§Ù…Ø¹-Ø§Ù†Ø³Ø§Ù†ÛŒ-Ø§Ø«Ø±-Ø¬Ù…Ø¹ÛŒ-Ø§Ø²-Ù†ÙˆÛŒØ³Ù†Ø¯Ú¯Ø§Ù†-Ø§Ù†ØªØ´Ø§Ø±Ø§Øª-Ø®ÛŒÙ„ÛŒ-Ø³Ø¨Ø²/',
    publisher: 'Ø®ÛŒÙ„ÛŒâ€ŒØ³Ø¨Ø²',
    tags: ['ØªØ³Øª','Ø¯Ø±Ø³Ù†Ø§Ù…Ù‡','Ø®ÛŒÙ„ÛŒâ€ŒØ³Ø¨Ø²','Ø¬Ø§Ù…Ø¹ ( ÙˆÛŒÚ˜Ù‡ ÛŒ Ù‡Ø± Ø³Ù‡ Ù¾Ø§ÛŒÙ‡ )','Ù†Ø±Ø¯Ø¨Ø§Ù…','ØªØ³Øª Ú©Ù†Ú©ÙˆØ±ÛŒ'],
    downloads: 0
  },
  'arabi10,11,12-loghme': {
  size: '152 MB', rate: 4.6, votes: 10,
  buy: 'https://www.digikala.com/product/dkp-6178064/Ú©ØªØ§Ø¨-Ø¯Ø±Ø³Ù†Ø§Ù…Ù‡-Ø¹Ø±Ø¨ÛŒ-Ú©Ù†Ú©ÙˆØ±-Ø§Ù†Ø³Ø§Ù†ÛŒ-Ù„Ù‚Ù…Ù‡-Ø·Ù„Ø§ÛŒÛŒ-ÙˆÛŒÚ˜Ù‡-Ú©Ù†Ú©ÙˆØ±-1401-Ø§Ø«Ø±-Ù…Ù‡Ø±Ø§Ù†-ØªØ±Ú©Ù…Ø§Ù†-Ù†Ø´Ø±-Ù…Ù‡Ø±-Ùˆ-Ù…Ø§Ù‡/',
  publisher: 'Ù…Ù‡Ø± Ùˆ Ù…Ø§Ù‡',
  tags: ['ØªØ³Øª','Ø¯Ø±Ø³Ù†Ø§Ù…Ù‡','Ù„Ù‚Ù…Ù‡','Ù…Ù‡Ø± Ùˆ Ù…Ø§Ù‡','Ø¬Ø§Ù…Ø¹ ( ÙˆÛŒÚ˜Ù‡ ÛŒ Ù‡Ø± Ø³Ù‡ Ù¾Ø§ÛŒÙ‡ )','ØªØ³Øª Ú©Ù†Ú©ÙˆØ±ÛŒ'],
  downloads: 0
}, // â†â† Ø§ÛŒÙ† ÙˆÛŒØ±Ú¯ÙˆÙ„ Ù„Ø§Ø²Ù… Ø¨ÙˆØ¯

'arabi10-gallery': {
  size: null, rate: null, votes: 0,
  buy: '', publisher: 'Ú©ØªØ§Ø¨ Ø¯Ø±Ø³ÛŒ',
  tags: ['Ù¾Ø§ÛŒÙ‡ Ø¯Ù‡Ù…','Ù†Ù…Ø§ÛŒØ´ ØµÙØ­Ø§Øª','Ú¯Ø§Ù„Ø±ÛŒ'],
  downloads: 0
},
};


/* ---- Ø§Ø¨Ø²Ø§Ø±Ù‡Ø§ÛŒ Ù…Ø­Ù„ÛŒ/Ø¹Ù…ÙˆÙ…ÛŒ ---- */
function lsGet(k,d){try{return JSON.parse(localStorage.getItem(k))??d}catch{return d}}
function lsSet(k,v){localStorage.setItem(k,JSON.stringify(v))}
const deviceId=(localStorage.getItem('device_id') || (()=>{const v='dvc_'+Math.random().toString(36).slice(2);localStorage.setItem('device_id',v);return v})());

/* ---- Ø¯Ø§Ù†Ù„ÙˆØ¯Ù‡Ø§ ---- */
async function getDownloads(book){
  try{
    const r=await fetch(`/api/downloads?book=${encodeURIComponent(book)}`,{cache:'no-store'});
    const d=await r.json(); if(!r.ok||typeof d.value!=='number') throw 0;
    return d.value;
  }catch{return lsGet('dl_'+book,0)}
}
async function addDownload(book){
  try{
    const r=await fetch('/api/downloads',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({book,inc:1})});
    const d=await r.json(); if(!r.ok||typeof d.value!=='number') throw 0;
    return d.value;
  }catch{
    const v=lsGet('dl_'+book,0)+1; lsSet('dl_'+book,v); return v;
  }
}

/* ---- Ø¬Ø³Øªâ€ŒÙˆØ¬Ùˆ ---- */
const searchInput=document.getElementById('searchInput');
const searchClear=document.getElementById('searchClear');
function normalize(s){
  return String(s||'')
    .replace(/\u200c/g,' ')
    .replace(/[â€Œ\u00A0]/g,' ')
    .replace(/ÙŠ/g,'ÛŒ').replace(/Ùƒ/g,'Ú©')
    .replace(/\s+/g,' ')
    .toLowerCase();
}
function filterBooks(){
  const v=normalize(searchInput.value||'');
  document.querySelectorAll('.books li').forEach(li=>{
    const t=li.querySelector('.title').textContent;
    li.style.display = normalize(t).includes(v) ? '' : 'none';
  });
  searchClear.style.display = v? 'flex':'none';
}
searchInput.addEventListener('input',filterBooks);
searchClear.addEventListener('click',()=>{searchInput.value='';filterBooks();searchInput.focus()});

/* ---- Ù…Ø±ØªØ¨â€ŒØ³Ø§Ø²ÛŒ Ù¾Ù†Ù„â€ŒÙ…Ø­ÙˆØ± Ø¨Ø§ Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ ØªØ±ØªÛŒØ¨ Ø§ÙˆÙ„ÛŒÙ‡ ---- */
const sortBtn=document.getElementById('btnSort');
const sortModal=document.getElementById('sortModal');
const sortList=document.getElementById('sortList');
const sortClose=document.getElementById('btnSortClose');
let currentSort='default';

function openSort(){
  sortModal.style.display = 'flex'; // Ù†Ù…Ø§ÛŒØ´ Ù…ÙˆØ¯Ø§Ù„ Ø¨Ø§ display flex
  setTimeout(() => sortModal.classList.add('show'), 10); // Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ú©Ù„Ø§Ø³ show Ø¨Ø±Ø§ÛŒ Ù†Ù…Ø§ÛŒØ´ Ù…ÙˆØ¯Ø§Ù„
}
function closeSort(){sortModal.classList.remove('show');setTimeout(()=>sortModal.style.display='none',160)}
sortBtn.addEventListener('click',openSort);
sortClose.addEventListener('click',closeSort);
sortModal.addEventListener('click',e=>{if(e.target===sortModal)closeSort()});

/* Ø«Ø¨Øª ØªØ±ØªÛŒØ¨ Ø§ÙˆÙ„ÛŒÙ‡ Ù‡Ø± Ù¾Ù†Ù„ */
function captureInitialOrder(){
  document.querySelectorAll('ul.books').forEach(ul=>{
    Array.from(ul.children).forEach((li,idx)=>{ li.dataset.order = String(idx) });
  });
}
captureInitialOrder();

sortList.querySelectorAll('li').forEach(li=>{
  li.addEventListener('click',async()=>{
    sortList.querySelectorAll('li').forEach(x=>x.classList.remove('active'));
    li.classList.add('active'); currentSort=li.dataset.sort;
    await applySort(); sortBtn.textContent='Ù…Ø±ØªØ¨â€ŒØ³Ø§Ø²ÛŒ: '+li.textContent.trim(); closeSort();
  })
});

function numFromSize(sizeStr){
  if(!sizeStr) return 9e9;
  const m=(sizeStr.match(/\d+/)||[0])[0];
  return parseInt(m,10)||9e9;
}

async function applySort(){
  const panels=[{ul:document.getElementById('list11'), key:'11'},{ul:document.getElementById('list10'), key:'10'}];

  panels.forEach(({ul})=>{
    const items=Array.from(ul.children).map(li=>{
      const id=li.dataset.id, meta=bookMeta[id]||{};
      const dl = parseInt(li.dataset.dl||'0',10);
      const fav= parseInt(li.dataset.fav||'0',10);
      const size=numFromSize(meta.size);
      const rate=(meta.rate==null? -1 : meta.rate);
      const order=parseInt(li.dataset.order||'0',10);
      return {li,id,dl,fav,size,rate,order};
    });

    switch(currentSort){
      case 'rate':       items.sort((a,b)=>b.rate-a.rate); break;
      case 'downloads':  items.sort((a,b)=>b.dl-a.dl);     break;
      case 'likes':      items.sort((a,b)=>b.fav-a.fav);   break;
      case 'size':       items.sort((a,b)=>a.size-b.size); break;
      default:           items.sort((a,b)=>a.order-b.order);break;
    }
    items.forEach(it=>ul.appendChild(it.li));
  });
}

/* ---- Ù…ÙˆØ¯Ø§Ù„ Ù¾ÛŒØ´â€ŒÙ†Ù…Ø§ÛŒØ´ ---- */
const pvModal=document.getElementById('previewModal');
const pvTitle=document.getElementById('pvTitle');
const pvBody=document.getElementById('pvBody');
const pvClose=document.getElementById('pvClose');
pvClose.addEventListener('click',()=>{pvModal.classList.remove('show');setTimeout(()=>pvModal.style.display='none',180)});
pvModal.addEventListener('click',e=>{if(e.target===pvModal) pvClose.click()});

function openPreview(card,id){
  const title = card.querySelector('.title').textContent.replace(/\(\d+ ?Ø¯Ø§Ù†Ù„ÙˆØ¯\)/,'').trim();
  const href  = card.dataset.href;
  const meta  = bookMeta[id]||{};
  const tags  = (meta.tags||[]).map(t=>`<span class="chip" style="pointer-events:none;opacity:.9">${t}</span>`).join(' ');
  pvTitle.textContent='Ù¾ÛŒØ´â€ŒÙ†Ù…Ø§ÛŒØ´ Â«'+title+'Â»';
  pvBody.innerHTML =
    `<div>Ø­Ø¬Ù… ÙØ§ÛŒÙ„: <b>${meta.size || 'Ù†Ø§Ù…Ø´Ø®Øµ'}</b></div>
     <div>Ù„ÛŒÙ†Ú© Ø¯Ø§Ù†Ù„ÙˆØ¯: ${href?`<a href="${href}" target="_blank" rel="noopener" style="color:#aef">Ø¨Ø§Ø² Ú©Ø±Ø¯Ù†</a>`:'Ù†Ø§Ù…Ø´Ø®Øµ'}</div>
     <div>Ø§Ù…ØªÛŒØ§Ø² Ø¯ÛŒØ¬ÛŒâ€ŒÚ©Ø§Ù„Ø§: <b>${meta.rate==null?'Ù†Ø§Ù…ÙˆØ¬ÙˆØ¯':faRate(meta.rate)}</b> ${meta.votes?`(Ø§Ø² ${faDigits(meta.votes)} Ø±Ø£ÛŒ)`:''}</div>
     <div style="margin-top:6px">Ø®Ø±ÛŒØ¯: ${meta.buy?`<a href="${meta.buy}" target="_blank" rel="noopener" style="color:#aef">Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ø¯Ø± Ø¯ÛŒØ¬ÛŒâ€ŒÚ©Ø§Ù„Ø§</a>`:'â€”'}</div>
    
     <div style="margin-top:8px">Ø¨Ø±Ú†Ø³Ø¨â€ŒÙ‡Ø§: ${tags || 'â€”'}</div>`;
  pvModal.style.display='flex'; setTimeout(()=>pvModal.classList.add('show'),10);
}

/* ---- Ù…ÙˆØ¯Ø§Ù„ Ú©Ø§Ù…Ù†Øªâ€ŒÙ‡Ø§ ---- */
const cmtModal=document.getElementById('cmtModal');
const cmtTitle=document.getElementById('cmtTitle');
const cmtList=document.getElementById('cmtList');
const cmtInput=document.getElementById('cmtInput');
const cmtName=document.getElementById('cmtName');
const cmtSend=document.getElementById('cmtSend');
const cmtClose=document.getElementById('cmtClose');

let currentBookForCmt=null, currentCmtCounterEl=null;

function openCmtModal(bookId,title,counterEl){
  currentBookForCmt=bookId; currentCmtCounterEl=counterEl;
  cmtTitle.textContent='Ú©Ø§Ù…Ù†Øªâ€ŒÙ‡Ø§ÛŒ '+title;
  cmtInput.value=''; cmtName.value='';
  cmtModal.style.display='flex'; setTimeout(()=>cmtModal.classList.add('show'),10);
  loadComments(bookId);
}
function closeCmtModal(){ cmtModal.classList.remove('show'); setTimeout(()=>cmtModal.style.display='none',150) }
cmtClose.addEventListener('click',closeCmtModal);
cmtModal.addEventListener('click',e=>{ if(e.target===cmtModal) closeCmtModal() });

async function loadComments(bookId){
  try{
    const r=await fetch(`/api/book-comments?slug=${encodeURIComponent(bookId)}`,{cache:'no-store'});
    const d=await r.json();
    if(!r.ok||!Array.isArray(d.list)) throw 0;
    renderComments(d.list);
    if(currentCmtCounterEl) currentCmtCounterEl.textContent=faDigits(d.list.length);
  }catch{
    renderComments([]); if(currentCmtCounterEl) currentCmtCounterEl.textContent='Û°';
  }
}
function renderComments(list){
  cmtList.innerHTML='';
  list.forEach(c=>{
    const li=document.createElement('li'); li.className='cmt-item';
    const head=document.createElement('div'); head.className='cmt-head';
    const uname=document.createElement('span');
    const nick = (c.nickname && c.nickname.trim()) ? c.nickname : 'Ú©Ø§Ø±Ø¨Ø± Ù†Ø§Ø´Ù†Ø§Ø³';
    uname.textContent = nick;
    head.appendChild(uname);
    const text=document.createElement('div'); text.className='cmt-text';
    text.textContent=(c.text||'');
    li.appendChild(head); li.appendChild(text);
    cmtList.appendChild(li);
  });
}
cmtSend.addEventListener('click',async()=>{
  const txt=(cmtInput.value||'').trim(); 
  const nick=(cmtName.value||'').trim();
  if(!txt) return;
  try{
    const r=await fetch(`/api/book-comments?slug=${encodeURIComponent(currentBookForCmt)}`,{
      method:'POST', headers:{'Content-Type':'application/json'},
      body:JSON.stringify({text:txt, nickname:nick})
    });
    const d=await r.json();
    if(r.ok && d && d.ok){ cmtInput.value=''; cmtName.value=''; await loadComments(currentBookForCmt); }
    else alert('Ø§Ø±Ø³Ø§Ù„ Ù†Ø´Ø¯.');
  }catch{ alert('Ø§Ø±Ø³Ø§Ù„ Ù†Ø´Ø¯.'); }
});

/* ---- Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§ + Ø¹Ù„Ø§Ù‚Ù‡â€ŒÙ…Ù†Ø¯ÛŒâ€ŒÙ‡Ø§ + Ø§Ø´ØªØ±Ø§Ú©â€ŒÚ¯Ø°Ø§Ø±ÛŒ Ø¨Ø§ Ù…ØªÙ† Ø«Ø§Ø¨Øª ---- */
function initCards(){
  const SITE_URL = (window.SITE_URL_OVERRIDE || 'https://learnbook.vercel.app/');
  const RTL = '\u200F';

  const makeRatingText = (meta)=>{
    if (meta.rate==null) return 'Ù†Ø§Ù…ÙˆØ¬ÙˆØ¯';
    const r = faRate(meta.rate);
    return `${r}${meta.votes?` (Ø§Ø² ${faDigits(meta.votes)} Ø±Ø£ÛŒ)`:''}`;
  };

  function makeShareText(title, dl, meta){
    const buy = meta.buy || 'â€”';
    const rating = makeRatingText(meta);
    return [
      `${RTL}ğŸ“˜ Ù†Ø§Ù… Ú©ØªØ§Ø¨:`,
      title,
      '',
      `${RTL}ğŸ“¥ Ù„ÛŒÙ†Ú© Ø¯Ø§Ù†Ù„ÙˆØ¯ PDF:`,
      dl || 'â€”',
      '',
      `${RTL}ğŸ›’ Ù„ÛŒÙ†Ú© Ø®Ø±ÛŒØ¯ (Ø¯ÛŒØ¬ÛŒâ€ŒÚ©Ø§Ù„Ø§):`,
      buy,
      '',
      `${RTL}â­ Ø§Ù…ØªÛŒØ§Ø²:`,
      rating,
      '',
      `${RTL}ğŸŒ Ø¨Ø±Ø§ÛŒ Ú©ØªØ§Ø¨â€ŒÙ‡Ø§ÛŒ Ø¨ÛŒØ´ØªØ±:`,
      SITE_URL
    ].join('\n');
  }

  document.querySelectorAll('.book-card').forEach(card=>{
    const li=card.closest('li'); const id=li.dataset.id;
    const countEl=card.querySelector('[data-dlc]');
    const starTip=card.querySelector('.star-tip');
    const meta=bookMeta[id]||{};
    const rateEl=card.querySelector('[data-rate]');
    const sizeEl=card.querySelector('[data-size]');
    const cmtCountEl=card.querySelector('[data-cmtcount]');
    const favLbl=card.querySelector('[data-favcount]');
    const favBtn=card.querySelector('.icon-wrap.fav');
    const titleText=card.querySelector('.title').firstChild.textContent.trim();

    function faDigitsInSize(sizeStr) {
  let match = sizeStr.match(/^(\d+)/);
  if (!match) return sizeStr;
  let num = match[1];
  let rest = sizeStr.slice(num.length);
  return faDigits(Number(num)) + rest;
}

sizeEl.textContent = meta.size ? faDigitsInSize(meta.size) : 'â€”';
    rateEl.textContent=faRate(meta.rate);

    // Ø¯Ø§Ù†Ù„ÙˆØ¯Ø´Ù…Ø§Ø± (Ù†Ù…Ø§ÛŒØ´ÛŒ + Ø¨Ø±Ø§ÛŒ Ø³ÙˆØ±Øª)
    getDownloads(id).then(v=>{
      li.dataset.dl = String(v||0);
      countEl.textContent=`(${faDigits(v||0)} Ø¯Ø§Ù†Ù„ÙˆØ¯)`;
    });

    // Tooltip Ø§Ù…ØªÛŒØ§Ø²
    card.querySelector('.icon-wrap.star').addEventListener('click',e=>{
      e.stopPropagation();
      let msg=(meta.rate==null)?'Ø¨Ø±Ø§ÛŒ Ø§ÛŒÙ† Ú©ØªØ§Ø¨ Ø§Ù…ØªÛŒØ§Ø²ÛŒ Ø¯Ø± Ø¯ÛŒØ¬ÛŒâ€ŒÚ©Ø§Ù„Ø§ Ø«Ø¨Øª Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª':`${faRate(meta.rate)} Ø§Ø² Ûµ ${meta.votes?`(Ø¨Ø± Ø§Ø³Ø§Ø³ ${faDigits(meta.votes)} Ø±Ø£ÛŒ)`:''}`;
      starTip.textContent=msg;
      starTip.classList.remove('hide'); starTip.classList.add('show');
      setTimeout(()=>{ starTip.classList.remove('show'); starTip.classList.add('hide') }, 6000);
    });

    // Ø§Ø´ØªØ±Ø§Ú©â€ŒÚ¯Ø°Ø§Ø±ÛŒ: ÙÙ‚Ø· Ù…ØªÙ†Ø› url Ø¬Ø¯Ø§Ú¯Ø§Ù†Ù‡ Ù†Ù…ÛŒâ€ŒÙØ±Ø³ØªÛŒÙ… ØªØ§ ØªÙ‡ Ù¾ÛŒØ§Ù… Ù†Ú†Ø³Ø¨Ø¯
    card.querySelector('.icon-wrap.share').addEventListener('click', async e=>{
      e.stopPropagation();
      const dl = card.dataset.href || '';
      const text = makeShareText(titleText, dl, meta);
      if (navigator.share) {
        try { await navigator.share({ title: titleText, text }); } catch {}
      } else {
        try {
          await navigator.clipboard.writeText(text);
          alert('Ù…ØªÙ† Ø§Ø´ØªØ±Ø§Ú©â€ŒÚ¯Ø°Ø§Ø±ÛŒ Ú©Ù¾ÛŒ Ø´Ø¯ âœ…');
        } catch {
          alert('Ú©Ù¾ÛŒ Ù†Ø´Ø¯Ø› Ù„Ø·ÙØ§Ù‹ Ø¯Ø³ØªÛŒ Ú©Ù¾ÛŒ Ú©Ù†ÛŒØ¯.');
        }
      }
    });

    // Ø®Ø±ÛŒØ¯
    card.querySelector('.icon-wrap.buy').addEventListener('click',e=>{
      e.stopPropagation(); if(meta.buy) window.open(meta.buy,'_blank','noopener');
    });
    

    // Ø¯Ø§Ù†Ù„ÙˆØ¯
    card.querySelector('.icon-wrap.dl').addEventListener('click',async e=>{
      e.stopPropagation();
      const nv=await addDownload(id);
      li.dataset.dl = String(nv||0);
      countEl.textContent=`(${faDigits(nv||0)} Ø¯Ø§Ù†Ù„ÙˆØ¯)`;
      const href=card.dataset.href; if(href) window.open(href,'_blank','noopener');
    });

    // Ú©Ø§Ù…Ù†Øªâ€ŒÙ‡Ø§
    card.querySelector('.icon-wrap.comment').addEventListener('click',e=>{
      e.stopPropagation();
      openCmtModal(id, 'Â«'+titleText+'Â»', cmtCountEl);
    });

    fetch(`/api/book-comments?slug=${encodeURIComponent(id)}`,{cache:'no-store'})
      .then(r=>r.json()).then(d=>{
        cmtCountEl.textContent = faDigits(Array.isArray(d.list)? d.list.length : 0);
      }).catch(()=>{ cmtCountEl.textContent='Û°' });

    /* === Ø¹Ù„Ø§Ù‚Ù‡â€ŒÙ…Ù†Ø¯ÛŒâ€ŒÙ‡Ø§ (Ø³ÛŒÙ†Ú© Ø¨Ø§ Ø³Ø±ÙˆØ± + localStorage) === */
    const FAVS_KEY='my_favs';
    const getMyFavs=()=>{ try{return JSON.parse(localStorage.getItem(FAVS_KEY))||[]}catch{return []} };
    const setMyFavs=v=>localStorage.setItem(FAVS_KEY, JSON.stringify(v));
    const isMyFav=id=>getMyFavs().includes(id);
    const addMyFav=id=>{ const s=new Set(getMyFavs()); s.add(id); setMyFavs([...s]) };
    const removeMyFav=id=>{ const s=new Set(getMyFavs()); s.delete(id); setMyFavs([...s]) };

    async function favGet(book){
      try{
        const r=await fetch(`/api/favorites?book=${encodeURIComponent(book)}&device=${encodeURIComponent(deviceId)}`,{cache:'no-store'});
        const d=await r.json(); return { count: d?.count ?? 0, isFav: !!d?.isFav };
      }catch{ return {count: (isMyFav(book)?1:0), isFav: isMyFav(book)} }
    }
    async function favToggle(book, toAdd){
      try{
        const r=await fetch('/api/favorites', { method:'POST', headers:{'Content-Type':'application/json'},
          body: JSON.stringify({ book, device: deviceId, op: toAdd?'add':'remove' }) });
        const d=await r.json();
        if(!r.ok) throw 0;
        return { count: d?.count ?? 0, isFav: !!d?.isFav };
      }catch{
        if (toAdd) addMyFav(book); else removeMyFav(book);
        return { count: 0, isFav: isMyFav(book) };
      }
    }

    // Ù„ÙˆØ¯ Ø§ÙˆÙ„ÛŒÙ‡ Ù„Ø§ÛŒÚ©
    favGet(id).then(({count,isFav})=>{
      favLbl.textContent=faDigits(count||0);
      li.dataset.fav = String(count||0);        // Ø¨Ø±Ø§ÛŒ Ù…Ø±ØªØ¨â€ŒØ³Ø§Ø²ÛŒ
      if(isFav) addMyFav(id); else removeMyFav(id);
      favBtn.classList.toggle('active', isFav);
    }).catch(()=>{ li.dataset.fav='0'; });

    // Ú©Ù„ÛŒÚ© Ù‚Ù„Ø¨
    favBtn.addEventListener('click', async (e)=>{
      e.stopPropagation();
      const willAdd=!favBtn.classList.contains('active');
      try{
        const {count,isFav}=await favToggle(id, willAdd);
        favLbl.textContent=faDigits(count||0);
        li.dataset.fav = String(count||0);      // Ø¢Ù¾Ø¯ÛŒØª Ø¨Ø±Ø§ÛŒ Ø³ÙˆØ±Øª
        if(isFav) addMyFav(id); else removeMyFav(id);
        favBtn.classList.toggle('active', isFav);
      }catch{}
    });

    // Ú©Ù„ÛŒÚ© Ø±ÙˆÛŒ Ú©Ø§Ø±Øª -> Ù¾ÛŒØ´â€ŒÙ†Ù…Ø§ÛŒØ´
    if (card.hasAttribute('data-gallery')) {
  const key = card.dataset.gallery;
  const titleText = card.querySelector('.title')?.firstChild?.textContent?.trim() || '';
  card.addEventListener('click', (e)=>{ e.stopPropagation(); window.openGallery(key, titleText); });
} else {
  card.addEventListener('click',()=> openPreview(card,id));
}

  });
}
initCards();
</script>

<script>
  /* === Ú¯Ø§Ù„Ø±ÛŒ ØªØµØ§ÙˆÛŒØ± Ø¯Ù‡Ù… (ØµÙØ­Ø§Øª Ú©ØªØ§Ø¨) === */
  const galleries = {
    'arabi10-lessons': [
      'https://s33.picofile.com/file/8484585200/%D8%AF%D8%B1%D8%B3_%D8%A7%D9%88%D9%84.jpg',
      'https://s33.picofile.com/file/8484585218/%D8%AF%D8%B1%D8%B3_%D8%AF%D9%88%D9%85_1.jpg',
      'https://s33.picofile.com/file/8484585226/%D8%AF%D8%B1%D8%B3_%D8%AF%D9%88%D9%85_2.jpg',
      'https://s33.picofile.com/file/8484585234/%D8%AF%D8%B1%D8%B3_%D8%B3%D9%88%D9%85_1.jpg',
      'https://s33.picofile.com/file/8484585242/%D8%AF%D8%B1%D8%B3_%D8%B3%D9%88%D9%85_2.jpg',
      'https://s33.picofile.com/file/8484585292/%D8%AF%D8%B1%D8%B3_%D8%B4%D8%B4%D9%85_1.jpg',
      'https://s33.picofile.com/file/8484585300/%D8%AF%D8%B1%D8%B3_%D8%B4%D8%B4%D9%85_2.jpg',
      'https://s33.picofile.com/file/8484585326/%D8%AF%D8%B1%D8%B3_%D8%B4%D8%B4%D9%85_3.jpg',
      'https://s33.picofile.com/file/8484585350/%D8%AF%D8%B1%D8%B3_%D9%87%D9%81%D8%AA%D9%85_1.jpg',
      'https://s33.picofile.com/file/8484585368/%D8%AF%D8%B1%D8%B3_%D9%87%D9%81%D8%AA%D9%85_2.jpg',
      'https://s33.picofile.com/file/8484585250/%D8%AF%D8%B1%D8%B3_%D9%BE%D9%86%D8%AC%D9%85_1.jpg',
      'https://s33.picofile.com/file/8484585276/%D8%AF%D8%B1%D8%B3_%D9%BE%D9%86%D8%AC%D9%85_2.jpg',
      'https://s33.picofile.com/file/8484585284/%D8%AF%D8%B1%D8%B3_%D9%BE%D9%86%D8%AC%D9%85_3.jpg',
      'https://s33.picofile.com/file/8484585384/%D8%AF%D8%B3_%D9%87%D9%81%D8%AA%D9%85_3.jpg'
    ]
  };
  
  (function(){
    const gModal = document.getElementById('galleryModal');
    const gTitle = document.getElementById('galTitle');
    const gStrip = document.getElementById('galStrip');
    const gPrev  = document.getElementById('galPrev');
    const gNext  = document.getElementById('galNext');
    const gClose = document.getElementById('galClose');
  
    function openGallery(key, titleText){
      const list = galleries[key] || [];
      if(!list.length) return;
  
      gTitle.textContent = 'Ú¯Ø§Ù„Ø±ÛŒ Â«' + (titleText || 'ØµÙØ­Ø§Øª Ú©ØªØ§Ø¨') + 'Â»';
      gStrip.innerHTML = '';
  
      list.forEach(src=>{
        const cell = document.createElement('div');
        const img  = document.createElement('img');
        img.loading = 'lazy';
        img.decoding = 'async';
        img.src = src;
        img.alt = 'page';
        img.style.maxWidth = '100%';
        cell.appendChild(img);
        gStrip.appendChild(cell);
      });
  
      gModal.style.display = 'flex';
      setTimeout(()=>gModal.classList.add('show'), 10);
      gStrip.scrollTo({left:0, behavior:'instant'});
    }
  
    function closeGallery(){
      gModal.classList.remove('show');
      setTimeout(()=>{ gModal.style.display='none'; }, 160);
    }
  
    function scrollByOne(dir){
      const first = gStrip.querySelector('img');
      const step  = first ? (first.getBoundingClientRect().width + 8) : gStrip.clientWidth * 0.9;
      gStrip.scrollBy({ left: dir * step, behavior: 'smooth' });
    }
  
    gPrev.addEventListener('click', ()=>scrollByOne(-1));
    gNext.addEventListener('click', ()=>scrollByOne(1));
    gClose.addEventListener('click', closeGallery);
    gModal.addEventListener('click', e=>{ if(e.target===gModal) closeGallery(); });
  
    // ÙÙ‚Ø· Ø¢ÛŒÚ©Ù† Â«viewÂ» Ú¯Ø§Ù„Ø±ÛŒ Ø±Ø§ Ø¨Ø§Ø² Ú©Ù†Ø¯
    document.querySelectorAll('.book-card[data-gallery]').forEach(card=>{
      const key = card.dataset.gallery;
      const titleText = card.querySelector('.title')?.firstChild?.textContent?.trim() || '';
      const viewBtn = card.querySelector('.icon-wrap.view');
      if (viewBtn) {
        viewBtn.addEventListener('click', e=>{
          e.stopPropagation();
          openGallery(key, titleText);
        });
      }
    });
  })();
  </script>
  
  
<script>
/* === ÙÛŒÙ„ØªØ± Ø¨Ø±Ú†Ø³Ø¨â€ŒÙ‡Ø§ (Ú†ÛŒÙ¾) â€” Ø¨Ø¯ÙˆÙ† Â«Ø³Ø§ÛŒØ±Â»ØŒ Ø­Ø°Ù ÙÛŒÙ„ØªØ± Ø¨Ø¯ÙˆÙ† Ø¨Ø³ØªÙ† Ù…ÙˆØ¯Ø§Ù„ === */
(function(){
  const tagsModal = document.getElementById('tagsModal');
  const tagsContainer = document.getElementById('tagsContainer');
  const btnTagsApply  = document.getElementById('btnTagsApply');
  const btnTagsDeleteAll  = document.getElementById('btnTagsDeleteAll');
  const btnTagsCancel = document.getElementById('btnTagsCancel');
  const btnTags = document.getElementById('btnTags');

  const BASE_GROUPS = {
    'Ù†ÙˆØ¹': ['ØªØ³Øª','ØªØ³Øª Ú©Ù†Ú©ÙˆØ±ÛŒ','Ø¯Ø±Ø³Ù†Ø§Ù…Ù‡','Ø§Ù…ØªØ­Ø§Ù† Ù†Ù‡Ø§ÛŒÛŒ'],
    'Ù†Ø§Ø´Ø±': ['Ø®ÛŒÙ„ÛŒâ€ŒØ³Ø¨Ø²','Ú¯Ø§Ø¬','Ù…Ø¨ØªÚ©Ø±Ø§Ù†','Ù…Ù‡Ø± Ùˆ Ù…Ø§Ù‡','Ù…Ø´Ø§ÙˆØ±Ø§Ù†'],
    'Ù…Ø¯Ù„ Ú©ØªØ§Ø¨': ['Ø´Ø¨ Ø§Ù…ØªØ­Ø§Ù†','Ù…Ø§Ø¬Ø±Ø§ÛŒ Ø¨ÛŒØ³Øª','ÙØ±Ù…ÙˆÙ„ Ø¨ÛŒØ³Øª','Ù…Ø§Ø¬Ø±Ø§Ù‡Ø§ÛŒ Ù…Ù† Ùˆ Ø¯Ø±Ø³Ø§Ù…','Ø¬ÛŒ Ø¨ÛŒ Ù†Ú©ØªÙ‡ Ø¨Ø§Ø²','ÙØµÙ„ Ø¢Ø²Ù…ÙˆÙ†','ÙˆØ§Ù‚Ø¹Ø§ Ø¬Ø§Ù…Ø¹ Ú©Ù†Ú©ÙˆØ±','Ú©ØªØ§Ø¨Ú†Ù‡ Ø¬Ø§Ù…Ø¹ Ú©Ù†Ú©ÙˆØ±','Ù„Ù‚Ù…Ù‡','Ø§Ù…ØªØ­Ø§Ù†Øª'],
    'Ù¾Ø§ÛŒÙ‡ ÛŒ Ù…Ø¯ Ù†Ø¸Ø±': ['Ù¾Ø§ÛŒÙ‡ Ø¯Ù‡Ù…','Ù¾Ø§ÛŒÙ‡ ÛŒØ§Ø²Ø¯Ù‡Ù…','Ù¾Ø§ÛŒÙ‡ Ø¯ÙˆØ§Ø²Ø¯Ù‡Ù…','Ø¬Ø§Ù…Ø¹ ( ÙˆÛŒÚ˜Ù‡ ÛŒ Ù‡Ø± Ø³Ù‡ Ù¾Ø§ÛŒÙ‡ )']
  };

  let selectedTags = new Set();
  let tempSelected = new Set();

  function normalizeTag(s){
    if (!s) return '';
    return String(s)
      .replace(/\u200c/g,' ')
      .replace(/[â€Œ\u00A0]/g,' ')
      .replace(/ÙŠ/g,'ÛŒ').replace(/Ùƒ/g,'Ú©')
      .replace(/\s+/g,' ')
      .trim();
  }

  function openModal(){ tempSelected=new Set(selectedTags); render(); tagsModal.style.display='flex'; setTimeout(()=>tagsModal.classList.add('show'),10); }
  function closeModal(){ tagsModal.classList.remove('show'); setTimeout(()=>tagsModal.style.display='none',160); }
  btnTags.addEventListener('click', openModal);
  tagsModal.addEventListener('click', e=>{ if(e.target===tagsModal) closeModal(); });

  function render(){
    const GROUPS = JSON.parse(JSON.stringify(BASE_GROUPS));
    const displayMap = {};
    Object.values(bookMeta||{}).forEach(m => (m.tags||[]).forEach(t=>{
      const n=normalizeTag(t); if(!displayMap[n]) displayMap[n]=t;
    }));
    const setType   = new Set(GROUPS['Ù†ÙˆØ¹'].map(normalizeTag));
    const setPub    = new Set(GROUPS['Ù†Ø§Ø´Ø±'].map(normalizeTag));
    const setModel  = new Set(GROUPS['Ù…Ø¯Ù„ Ú©ØªØ§Ø¨'].map(normalizeTag));
    const setGrade  = new Set(GROUPS['Ù¾Ø§ÛŒÙ‡ ÛŒ Ù…Ø¯ Ù†Ø¸Ø±'].map(normalizeTag));

    const existing = new Set();
    Object.values(bookMeta||{}).forEach(m => (m.tags||[]).forEach(t=> existing.add(normalizeTag(t))));

    // Ù‡Ø± ØªÚ¯ÛŒ Ú©Ù‡ Ø¯Ø± Ú¯Ø±ÙˆÙ‡â€ŒÙ‡Ø§ÛŒ Ø¨Ø§Ù„Ø§ Ù†ÛŒØ³ØªØŒ Ø¨Ù‡ "Ù†ÙˆØ¹" Ø§Ø¶Ø§ÙÙ‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯
    const toType = [...existing].filter(t=> !setPub.has(t) && !setModel.has(t) && !setGrade.has(t) && !setType.has(t));
    GROUPS['Ù†ÙˆØ¹'] = [...GROUPS['Ù†ÙˆØ¹'], ...toType.map(n=>displayMap[n])];

    let html='';
    Object.entries(GROUPS).forEach(([g,tags])=>{
      const seen=new Set();
      const chips = tags
        .filter(x=>{const n=normalizeTag(x); if(seen.has(n))return false; seen.add(n); return true;})
        .sort((a,b)=>normalizeTag(a).localeCompare(normalizeTag(b),'fa'))
        .map(t=> `<button type="button" class="chip" data-tag="${t}">${t}</button>`).join('');
      html += `<div class="tag-group"><div class="tag-group-title">${g}</div><div class="tag-group-body">${chips}</div></div>`;
    });
    tagsContainer.innerHTML=html;

    tempSelected.forEach(t=>{
      const sel=normalizeTag(t);
      tagsContainer.querySelectorAll('.chip').forEach(el=>{
        if (normalizeTag(el.dataset.tag)===sel) el.classList.add('active');
      });
    });
  }

  tagsContainer.addEventListener('click', e=>{
    const chip=e.target.closest('.chip'); if(!chip) return;
    const tag=chip.dataset.tag; const n=normalizeTag(tag);
    chip.classList.toggle('active');
    if(chip.classList.contains('active')) tempSelected.add(n);
    else tempSelected.delete(n);
  });

  function applyFilter(){
    const active=[...selectedTags];
    document.querySelectorAll('.books li').forEach(li=>{
      const id=li.dataset.id, meta=(bookMeta||{})[id]||{};
      const tags=(meta.tags||[]).map(normalizeTag);
      const ok = active.length===0 ? true : active.every(t=> tags.includes(t));
      li.style.display = ok ? '' : 'none';
    });
  }

  btnTagsApply.addEventListener('click', ()=>{ selectedTags=new Set(tempSelected); applyFilter(); closeModal(); });
  btnTagsDeleteAll.addEventListener('click', ()=>{
    selectedTags.clear();
    tempSelected.clear();
    tagsContainer.querySelectorAll('.chip.active').forEach(c=>c.classList.remove('active'));
    applyFilter(); // Ù…ÙˆØ¯Ø§Ù„ Ø¨Ø§Ø² Ù…ÛŒâ€ŒÙ…Ø§Ù†Ø¯
  });
  btnTagsCancel.addEventListener('click', ()=>{ tempSelected=new Set(selectedTags); closeModal(); });
})();
</script>
  
<!-- === Dual Counter Widget (Compact) === -->
<!-- === Zekr Widget (Salawat + Laan) === -->
<div id="gc-widget" style="
  position:fixed; right:14px; bottom:14px; z-index:9999; direction:rtl; font-family:inherit;
  transition: transform .18s ease, opacity .18s ease;
">
  <div style="
    background: rgba(255,255,255,0.12);
    border: 1px solid rgba(255,255,255,0.2);
    box-shadow: 0 8px 20px rgba(0,0,0,.35);
    backdrop-filter: blur(6px);
    color:#fff; padding:8px 10px; border-radius:12px; min-width:210px;
  ">
    <div style="display:flex; align-items:center; justify-content:space-between; gap:8px; margin-bottom:4px">
      <div style="font-weight:800; font-size:13.5px; text-shadow:0 2px 5px rgba(0,0,0,.45)">
        Ø°Ú©Ø±Ù‡Ø§ÛŒ Ù‡Ù…Ú¯Ø§Ù†ÛŒ
      </div>
      <button id="gc-close" aria-label="Ø¨Ø³ØªÙ†" title="Ø¨Ø³ØªÙ†" style="
        width:24px; height:24px; border:none; border-radius:7px; cursor:pointer; color:#fff;
        background:rgba(255,255,255,.18); box-shadow:0 3px 10px rgba(0,0,0,.3);
        display:flex; align-items:center; justify-content:center; font-weight:900;
        line-height:1;
      ">Ã—</button>
    </div>

    <div style="display:grid; grid-template-columns: auto 1fr auto; align-items:center; gap:6px 8px">
      <!-- Salawat row -->
      <div style="opacity:.92; font-size:13px">ØµÙ„ÙˆØ§Øª:</div>
      <b id="gc-salawat" style="font-size:13px; text-align:left">â€”</b>
      <button id="gc-salawat-inc" style="
        border:none; cursor:pointer; color:#fff; font-size:12px;
        background: linear-gradient(135deg,#34d399,#10b981);
        box-shadow: 0 5px 14px rgba(0,0,0,.32);
        border-radius:8px; padding:6px 9px; font-family:inherit;
      ">+ Ø§Ø¶Ø§ÙÙ‡</button>

      <!-- Laan row -->
      <div style="opacity:.92; font-size:13px">Ù„Ø¹Ù†:</div>
      <b id="gc-laan" style="font-size:13px; text-align:left">â€”</b>
      <button id="gc-laan-inc" style="
        border:none; cursor:pointer; color:#fff; font-size:12px;
        background: linear-gradient(135deg,#f87171,#ef4444);
        box-shadow: 0 5px 14px rgba(0,0,0,.32);
        border-radius:8px; padding:6px 9px; font-family:inherit;
      ">+ Ø§Ø¶Ø§ÙÙ‡</button>
    </div>
  </div>
</div>

<div id="gc-toast" style="
  position:fixed; left:50%; transform:translateX(-50%) translateY(16px);
  bottom:10px; z-index:10000; pointer-events:none;
  opacity:0; transition: opacity .22s ease, transform .22s ease;
">
  <div id="gc-toast-text" style="
    background: rgba(0,0,0,.6); color:#fff; padding:8px 12px; border-radius:9px;
    border:1px solid rgba(255,255,255,.2); box-shadow:0 8px 18px rgba(0,0,0,.35);
    font-size:12.5px; backdrop-filter: blur(4px); white-space:nowrap;
  "></div>
</div>

<script>
(function(){
  // Ø§Ø¹Ø¯Ø§Ø¯ ÙØ§Ø±Ø³ÛŒ
  const fa = v => (typeof v==='number' ? v.toLocaleString('fa-IR') : String(v).replace(/\d/g,d=>'Û°Û±Û²Û³Û´ÛµÛ¶Û·Û¸Û¹'[d]));
  // Ø¹Ù†Ø§ØµØ±
  const w   = document.getElementById('gc-widget');
  const valS= document.getElementById('gc-salawat');
  const valL= document.getElementById('gc-laan');
  const btnS= document.getElementById('gc-salawat-inc');
  const btnL= document.getElementById('gc-laan-inc');
  const btnX= document.getElementById('gc-close');
  const toast = document.getElementById('gc-toast');
  const toastText = document.getElementById('gc-toast-text');

  // Ø§ÙÚ©Øª Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§
  [btnS, btnL].forEach(b=>{
    b.addEventListener('pointerdown', ()=> b.style.transform='scale(0.97)');
    b.addEventListener('pointerup',   ()=> b.style.transform='scale(1)');
    b.addEventListener('pointercancel',()=> b.style.transform='scale(1)');
    b.addEventListener('mouseleave',  ()=> b.style.transform='scale(1)');
  });

  function showToast(msg){
    toastText.textContent = msg;
    toast.style.opacity = '1';
    toast.style.transform = 'translateX(-50%) translateY(0)';
    clearTimeout(showToast._t);
    showToast._t = setTimeout(()=>{
      toast.style.opacity = '0';
      toast.style.transform = 'translateX(-50%) translateY(16px)';
    }, 3200);
  }

  function closeWidget(){
    w.style.opacity = '0';
    w.style.transform = 'translateY(8px) scale(0.985)';
    setTimeout(()=>{ w.style.display='none'; }, 160);
    showToast('Ø§Ø¨Ø²Ø§Ø± Ø°Ú©Ø± Ø¨Ø³ØªÙ‡ Ø´Ø¯Ø› Ø¨Ø±Ø§ÛŒ Ø¨Ø±Ú¯Ø´ØªÙ†ØŒ ØµÙØ­Ù‡ Ø±Ø§ Ø±ÙØ±Ø´ Ú©Ù†ÛŒØ¯.');
  }

  // ÙˆØ§Ú©Ø´ÛŒ Ù…Ù‚Ø¯Ø§Ø±Ù‡Ø§
  async function refresh(){
    try{
      const [rS, rL] = await Promise.all([
        fetch('/api/global-counter?type=salawat',{cache:'no-store'}),
        fetch('/api/global-counter?type=laan',{cache:'no-store'})
      ]);
      const dS = await rS.json();
      const dL = await rL.json();
      if(!rS.ok || !rL.ok || typeof dS.value!=='number' || typeof dL.value!=='number') throw 0;
      valS.textContent = fa(dS.value);
      valL.textContent = fa(dL.value);
    }catch{
      valS.textContent = 'Ø®Ø·Ø§';
      valL.textContent = 'Ø®Ø·Ø§';
    }
  }

  async function inc(which){
    const btn = which==='salawat' ? btnS : btnL;
    btn.disabled = true;
    try{
      const r = await fetch(`/api/global-counter?type=${which}`, { method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify({ inc: 1 }) });
      const d = await r.json();
      if(!r.ok || typeof d.value!=='number') throw 0;
      if(which==='salawat') valS.textContent = fa(d.value);
      else                   valL.textContent = fa(d.value);
    }catch{
      showToast('Ù†ØªÙˆÙ†Ø³ØªÙ… Ø§ÙØ²Ø§ÛŒØ´ Ø¨Ø¯Ù…Ø› Ø¯ÙˆØ¨Ø§Ø±Ù‡ ØªÙ„Ø§Ø´ Ú©Ù†.');
    }finally{
      btn.disabled = false;
    }
  }

  btnS.addEventListener('click', ()=> inc('salawat'));
  btnL.addEventListener('click', ()=> inc('laan'));
  btnX.addEventListener('click', closeWidget);

  refresh();
})();
</script>
<!-- === /Zekr Widget === -->

  

<!-- toast -->
<div id="gc-toast" style="
  position:fixed; left:50%; transform:translateX(-50%) translateY(16px);
  bottom:10px; z-index:10000; pointer-events:none;
  opacity:0; transition: opacity .25s ease, transform .25s ease;
">
  <div style="
    background: rgba(0,0,0,.6); color:#fff; padding:7px 10px; border-radius:8px;
    border:1px solid rgba(255,255,255,.2); box-shadow:0 4px 12px rgba(0,0,0,.25);
    font-size:12.5px; backdrop-filter: blur(3px); white-space:nowrap;
  " id="gc-toast-text"></div>
</div>


</body>
</html>
.
