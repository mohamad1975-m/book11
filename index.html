<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>کتاب‌های کمک‌درسی تاریخ</title>
  <style>
    /* 🎨 فونت ایران‌یکان */
    @font-face {
      font-family: 'iranyekan';
      src: url('iranyekanweblight.woff') format('woff');
    }

    /* 🎨 تنظیمات کلی صفحه (فقط بک‌گراند به #222222 برگشت) */
    body{
      font-family:'iranyekan',sans-serif;
      background-color:#222222;   /* ← طبق درخواست شما */
      color:#fff;
      margin:0;
      padding:0;
      text-align:center;
    }

    /* 🟢 هدر (دست‌نخورده) */
    header{
      background-color:#1C93E3;
      color:#fff;
      padding:20px;
      font-size:22px;
      font-weight:bold;
    }

    /* 📚 لیست کتاب‌ها */
    .book-list{max-width:500px;margin:30px auto;padding:0;list-style:none}

    /* 🔵 آیتم‌ها (دست‌نخورده) */
    .book-item{
      background-color:#28A745;
      padding:15px;margin:10px 0;border-radius:8px;
      box-shadow:0 2px 5px rgba(0,0,0,.3);
      transition:transform .2s ease, box-shadow .2s ease;
    }
    .book-item:hover{transform:translateY(-3px);box-shadow:0 4px 12px rgba(0,0,0,.5)}
    .book-item a{text-decoration:none;color:#fff;font-weight:bold}

    /* 📱 ریسپانسیو */
    @media (max-width:500px){
      header{font-size:18px}
      .book-item{font-size:14px}
    }

    /* 📊 شمارنده */
    #counter{margin:30px 0;font-size:11px;color:#ccc}
  </style>
</head>
<body>

  <header>📚 کتاب‌های کمک‌درسی تاریخ</header>

  <ul class="book-list">
    <li class="book-item">
      <a href="https://mega.nz/file/tmgwVKRA#LkrI54ta-_8RQcato_aABuFHHhThghOvjQzWXjfPQ4k" target="_blank">
        ماجرای بیست – خیلی سبز
      </a>
    </li>
    <li class="book-item">
      <a href="https://mega.nz/file/ViBikQ7C#a6qWI8LcF28a8FVpS8z1CZEt4yeVZAn2V1bkOzdCCFQ" target="_blank">
        ماجراهای من و درسام – خیلی سبز
      </a>
    </li>
    <li class="book-item">
      <a href="https://s34.picofile.com/file/8486137768/tarikh11_shab.pdf.html" target="_blank">
        شب امتحان – خیلی سبز
      </a>
    </li>
  </ul>

<!-- 📊 نمایش شمارنده بازدید -->
<div id="counter">
  <span id="visit-count">در حال بارگذاری...</span>
</div>

<!-- 📊 اسکریپت برای شمارش بازدید (با Backend خودت + fallback لوکال) -->
<script>
  async function loadVisits() {
    const slug = (location.pathname.replace(/[^\w]+/g, '_') || 'index');

    try {
      const res = await fetch(`/api/visits?slug=${encodeURIComponent(slug)}`, { cache: 'no-store' });
      const data = await res.json();

      if (!res.ok || typeof data.value !== 'number') {
        throw new Error('bad response');
      }

      document.getElementById('visit-count').textContent =
        `بازدید این صفحه: ${data.value}`;
    } catch (e) {
      // 👇 اگر سرور در دسترس نبود، یه شمارنده‌ی تقریبی لوکال برای کاربر فعلی
      const k = `local_visits_${slug}`;
      const n = (parseInt(localStorage.getItem(k) || '0', 10) + 1);
      localStorage.setItem(k, n);
      document.getElementById('visit-count').textContent =
        `بازدید این صفحه (لوکال): ${n}`;
    }
  }
  loadVisits();
</script>


</body>
</html>


