<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Ø¬ØºØ±Ø§ÙÛŒØ§</title>
<style>
  /* --- Font --- */
  @font-face{font-family:'iranyekanX';src:url('IRANYekanX-Light.woff2') format('woff2')}
  *{box-sizing:border-box}
  body{
    font-family:'iranyekanX',sans-serif;margin:0;padding:0;color:#fff;
    background:radial-gradient(circle at 20% 20%,#e3f2fd,transparent 40%),
               radial-gradient(circle at 80% 25%,#d4fc79,transparent 42%),
               radial-gradient(circle at 20% 80%,#96e6a1,transparent 45%),
               radial-gradient(circle at 80% 75%,#8fd3f4,transparent 40%),
               linear-gradient(180deg,#58a 0%,#2c3e50 100%);
    background-attachment:fixed;min-height:100vh;position:relative;
  }
  body::before{content:"";position:fixed;inset:0;background:linear-gradient(to bottom,rgba(0,0,0,.15),rgba(0,0,0,.25));pointer-events:none;z-index:0}
  header{
    text-align:center;font-weight:800;margin:26px 0 10px;font-size:38px;
    background:linear-gradient(90deg,#60a5fa,#a78bfa,#34d399,#fbbf24,#f87171);
    background-size:400% 400%;
    -webkit-background-clip:text;-webkit-text-fill-color:transparent;
    animation:headGrad 18s ease infinite;text-shadow:0 0 10px rgba(255,255,255,.25);position:relative;z-index:1
  }
  @keyframes headGrad{0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}}

  /* --- Toolbar --- */
  .toolbar{width:min(920px,95%);margin:0 auto 8px;display:flex;gap:10px;justify-content:space-between;align-items:center;z-index:2;position:relative}
  .search-box{flex:1;position:relative}
  .search-input{width:100%;border:none;border-radius:12px;padding:12px 40px 12px 36px;background:rgba(255,255,255,.14);color:#fff;font-family:inherit;outline:none;box-shadow:0 8px 18px rgba(0,0,0,.28);border:1px solid rgba(255,255,255,.15)}
  .search-input::placeholder{color:#FFFFFF}
  .search-clear{position:absolute;left:10px;top:50%;transform:translateY(-50%);width:22px;height:22px;border-radius:50%;background:rgba(255,255,255,.2);display:none;align-items:center;justify-content:center;cursor:pointer;color:#fff;box-shadow:0 4px 10px rgba(0,0,0,.3);font-weight:900}
  .search-icon{position:absolute;right:10px;top:50%;transform:translateY(-50%);opacity:.9}
  .sort-btn{border:none;border-radius:12px;padding:12px 16px;cursor:pointer;color:#fff;background:linear-gradient(135deg,#1C93E3,#2ea3f2);box-shadow:0 8px 18px rgba(28,147,227,.4);font-family:inherit}

  /* --- Panels --- */
  .panel{width:min(920px,95%);margin:12px auto 20px;padding:22px 20px 26px;background:rgba(255,255,255,.12);border:1px solid rgba(255,255,255,.2);border-radius:18px;box-shadow:0 10px 25px rgba(0,0,0,.35);backdrop-filter:blur(6px);position:relative;z-index:1}
  .panel h2{margin:0 0 18px;font-size:22px;color:#f1f5f9;text-shadow:0 2px 8px rgba(0,0,0,.4)}
  ul.books{list-style:none;margin:0;padding:0}
  li{margin:10px 0}

  /* --- Book Card --- */
  .book-card{
    display:grid;grid-template-columns:110px 1fr;align-items:center;direction:ltr;gap:10px;text-decoration:none;color:#fff;background:rgba(255,255,255,.10);border:1px solid rgba(255,255,255,.15);padding:14px;border-radius:12px;box-shadow:0 6px 18px rgba(0,0,0,.28);transition:transform .18s ease,box-shadow .18s ease,background .18s ease;position:relative
  }
  .book-card:hover{transform:translateY(-3px);background:rgba(255,255,255,.16);box-shadow:0 12px 28px rgba(0,0,0,.45)}
  .title{font-size:16.5px;line-height:1.6;white-space:normal;word-wrap:break-word;text-shadow:0 2px 6px rgba(0,0,0,.45);direction:rtl}
  .dcount{font-size:13px;opacity:.9}

  /* --- Icons left area (Download/Star/Share/Buy/Comment) --- */
  .left-acts{display:grid;grid-template-columns:38px 38px;grid-template-rows:38px 14px 38px 14px 38px 14px;gap:6px 8px;align-items:center;justify-items:center;min-width:110px}
  .left-acts .icon-wrap{width:38px;height:38px;display:flex;align-items:center;justify-content:center;cursor:pointer;border-radius:10px;background:rgba(255,255,255,.12);border:1px solid rgba(255,255,255,.18);box-shadow:0 6px 16px rgba(0,0,0,.35);transition:transform .15s ease,background .15s ease}
  .left-acts .icon-wrap:hover{transform:translateY(-2px);background:rgba(255,255,255,.16)}
  .left-acts svg{width:22px;height:22px;fill:#fff;filter:drop-shadow(0 2px 4px rgba(0,0,0,.45))}
  .under-txt,.under-txt2,.under-txt3{font-size:11.5px;color:#eaeaea;direction:rtl}
  .dl{grid-column:1;grid-row:1}.u-size{grid-column:1;grid-row:2}
  .star{grid-column:2;grid-row:1}.u-rate{grid-column:2;grid-row:2}
  .share{grid-column:1;grid-row:3}
  .buy{grid-column:2;grid-row:3}
  .cmt{grid-column:2;grid-row:5}
  .u-cmt{grid-column:2;grid-row:6}

  /* --- Star tooltip --- */
  .star-tip{position:absolute;right:110px;bottom:10px;background:rgba(0,0,0,.65);border:1px solid rgba(255,255,255,.15);color:#fff;font-size:12.5px;padding:6px 10px;border-radius:10px;box-shadow:0 10px 25px rgba(0,0,0,.35);opacity:0;transform:translateY(12px);pointer-events:none;transition:all .35s ease;max-width:68%;line-height:1.8;direction:rtl}
  .star-tip.show{opacity:1;transform:translateY(0)}
  .star-tip.hide{opacity:0;transform:translateY(18px)}

  .btn-back{display:inline-block;margin:24px auto 10px;background:linear-gradient(135deg,#1C93E3,#2ea3f2);padding:12px 26px;color:#fff;text-decoration:none;border-radius:12px;box-shadow:0 8px 18px rgba(28,147,227,.4);transition:transform .15s ease,box-shadow .15s ease}
  .btn-back:hover{transform:translateY(-2px);box-shadow:0 12px 26px rgba(28,147,227,.6)}
  #counter{text-align:center;margin:12px 0 24px;font-size:15px;color:#eaeaea;text-shadow:0 2px 6px rgba(0,0,0,.45)}

  /* --- Preview modal --- */
  .modal{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,.5);z-index:50}
  .modal .box{width:min(680px,92%);border-radius:16px;background:rgba(255,255,255,.12);border:1px solid rgba(255,255,255,.2);box-shadow:0 18px 40px rgba(0,0,0,.45);padding:14px 16px;backdrop-filter:blur(6px);color:#fff;position:relative;transform:scale(.95);opacity:0;transition:all .25s ease;direction:rtl}
  .modal.show .box{transform:scale(1);opacity:1}
  .modal h3{margin:6px 0 12px;font-size:18px}
  .modal .row{display:flex;gap:8px;justify-content:flex-end;align-items:center;margin-top:8px;flex-wrap:wrap}
  .btn{border:none;border-radius:10px;padding:8px 16px;cursor:pointer;color:#fff;box-shadow:0 6px 16px rgba(0,0,0,.35);background:linear-gradient(135deg,#34d399,#10b981);font-family:inherit}
  .btn.gray{background:linear-gradient(135deg,#64748b,#475569)}
  .btn.mini{padding:6px 10px;font-size:12.5px;border-radius:8px}

  /* --- Sort modal --- */
  .modal-sort{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,.5);z-index:60}
  .modal-sort .box{width:min(520px,92%);border-radius:16px;background:rgba(255,255,255,.12);border:1px solid rgba(255,255,255,.2);box-shadow:0 18px 40px rgba(0,0,0,.45);padding:14px 16px;backdrop-filter:blur(6px);color:#fff;position:relative;transform:scale(.94);opacity:0;transition:all .2s ease;direction:rtl}
  .modal-sort.show .box{transform:scale(1);opacity:1}
  .sort-title{font-size:16px;margin-bottom:10px}
  .sort-list{list-style:none;margin:0;padding:0}
  .sort-list li{margin:8px 0;padding:10px 12px;border-radius:10px;background:rgba(255,255,255,.10);border:1px solid rgba(255,255,255,.15);cursor:pointer;transition:all .15s ease}
  .sort-list li:hover{background:rgba(255,255,255,.16)}
  .sort-list li.active{background:linear-gradient(135deg,#34d399,#10b981)}
  .modal-sort .row{display:flex;gap:8px;justify-content:flex-end;margin-top:10px}

  /* --- Comments modal --- */
  .modal-cmt{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,.55);z-index:70}
  .modal-cmt .box{width:min(720px,92%);border-radius:16px;background:rgba(255,255,255,.12);border:1px solid rgba(255,255,255,.2);box-shadow:0 18px 40px rgba(0,0,0,.45);padding:12px 14px;backdrop-filter:blur(6px);color:#fff;direction:rtl;transform:translateY(8px);opacity:0;transition:all .25s ease}
  .modal-cmt.show .box{transform:translateY(0);opacity:1}
  .cmt-title{font-size:16.5px;margin:4px 0 10px}
  .cmt-list{list-style:none;margin:0;padding:0;max-height:290px;overflow:auto}
  .cmt-item{background:rgba(255,255,255,.1);border:1px solid rgba(255,255,255,.15);border-radius:10px;padding:10px;margin:8px 0}
  .cmt-head{font-size:12.5px;color:#e5e5e5;margin-bottom:6px}
  .cmt-text{font-size:14.5px;line-height:1.9;white-space:pre-wrap}
  .cmt-actions{display:flex;gap:8px;margin-top:8px}
  .reply-list{margin-top:6px;padding-right:10px;border-right:2px solid rgba(255,255,255,.18)}
  .cmt-foot{margin-top:8px;display:flex;gap:8px;align-items:center}
  .cmt-foot textarea{flex:1;min-height:70px;border:none;border-radius:10px;padding:10px;background:rgba(255,255,255,.9);color:#111;font-family:inherit}
  .note{font-size:12.5px;opacity:.9;margin-top:6px}
</style>
</head>
<body>
<header>Ø¬ØºØ±Ø§ÙÛŒØ§ ğŸ“˜</header>

<div class="toolbar">
  <div class="search-box">
    <input id="searchInput" class="search-input" type="text" placeholder="Ø¬Ø³Øªâ€ŒÙˆØ¬Ùˆ Ø¨ÛŒÙ† Ú©ØªØ§Ø¨â€ŒÙ‡Ø§"/>
    <span class="search-icon">ğŸ”</span>
    <span id="searchClear" class="search-clear">Ã—</span>
  </div>
  <button id="btnSort" class="sort-btn">Ù…Ø±ØªØ¨â€ŒØ³Ø§Ø²ÛŒ: Ù¾ÛŒØ´â€ŒÙØ±Ø¶</button>
</div>

<!-- Panel: ÛŒØ§Ø²Ø¯Ù‡Ù… -->
<section class="panel" data-panel="11">
  <h2>Ú©ØªØ§Ø¨â€ŒÙ‡Ø§ÛŒ Ø¬ØºØ±Ø§ÙÛŒØ§ØŒ Ù¾Ø§ÛŒÙ‡ ÛŒØ§Ø²Ø¯Ù‡Ù…</h2>
  <ul class="books" id="list11">
    <li data-id="geo11-test">
      <div class="book-card" data-href="https://mega.nz/file/EygHRLaZ#XYM70813eKudH6DVdHsdduHbCb9I5d-W6NqhVDMngfs">
        <div class="left-acts">
          <div class="icon-wrap dl" title="Ø¯Ø§Ù†Ù„ÙˆØ¯"><svg viewBox="0 0 24 24"><path d="M12 16l4-5h-3V4h-2v7H8l4 5zm8 2H4v2h16v-2z"/></svg></div>
          <div class="icon-wrap star" title="Ø§Ù…ØªÛŒØ§Ø²"><svg viewBox="0 0 24 24"><path d="M12 .587l3.668 7.431L24 9.753l-6 5.847 1.416 8.263L12 19.771 4.584 23.863 6 15.6 0 9.753l8.332-1.735z"/></svg></div>
          <div class="under-txt u-size" data-size>88 MB</div>
          <div class="under-txt2 u-rate" data-rate>ØŸ</div>
          <div class="icon-wrap share" title="Ø§Ø´ØªØ±Ø§Ú©â€ŒÚ¯Ø°Ø§Ø±ÛŒ"><svg viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7a3.28 3.28 0 000-1.39l7.05-4.11A2.99 2.99 0 0018 7.91c1.66 0 3-1.34 3-3S19.66 2 18 2s-3 1.34-3 3c0 .23.03.45.08.66L7.91 9.77A2.99 2.99 0 006 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.73 0 1.4-.26 1.91-.69l7.21 4.2c-.05.2-.08.41-.08.63A3 3 0 1018 16.08z"/></svg></div>
          <div class="icon-wrap buy" title="Ø®Ø±ÛŒØ¯"><svg viewBox="0 0 24 24"><path d="M7 4H5L4 6H0v2h2l3.6 7.59c-.35.59-.6 1.27-.6 2.01A3.5 3.5 0 008.5 21c1.61 0 2.96-1.07 3.36-2.5h2.28A3.5 3.5 0 0017.5 21 3.5 3.5 0 0021 17.5c0-1.23-.66-2.29-1.64-2.86l1.66-7.64H7V4zm0 4h11.1l-1.25 5.75H8.53L7 8z"/></svg></div>
          <div class="icon-wrap cmt" title="Ù†Ø¸Ø±Ø§Øª"><svg viewBox="0 0 24 24"><path d="M20 2H4a2 2 0 00-2 2v18l4-4h14a2 2 0 002-2V4a2 2 0 00-2-2z"/></svg></div>
          <div class="under-txt3 u-cmt" data-cmt>0</div>
        </div>
        <span class="title">Ù¾Ø±Ø³Ø´â€ŒÙ‡Ø§ÛŒ Ú†Ù‡Ø§Ø±Ú¯Ø²ÛŒÙ†Ù‡â€ŒØ§ÛŒ (Ø¨Ù‡ Ù‡Ù…Ø±Ø§Ù‡ Ø¯Ø±Ø³Ù†Ø§Ù…Ù‡) â€“ Ø®ÛŒÙ„ÛŒ Ø³Ø¨Ø² <span class="dcount" data-dlc>(0 Ø¯Ø§Ù†Ù„ÙˆØ¯)</span></span>
        <div class="star-tip"></div>
      </div>
    </li>

    <li data-id="geo11-shab">
      <div class="book-card" data-href="https://mega.nz/file/R2YkAK7L#s2sUeQnr4IZ4IEx2vr9vFQMNZmSAcdDw4ggAtAatlqw">
        <div class="left-acts">
          <div class="icon-wrap dl" title="Ø¯Ø§Ù†Ù„ÙˆØ¯"><svg viewBox="0 0 24 24"><path d="M12 16l4-5h-3V4h-2v7H8l4 5zm8 2H4v2h16v-2z"/></svg></div>
          <div class="icon-wrap star" title="Ø§Ù…ØªÛŒØ§Ø²"><svg viewBox="0 0 24 24"><path d="M12 .587l3.668 7.431L24 9.753l-6 5.847 1.416 8.263L12 19.771 4.584 23.863 6 15.6 0 9.753l8.332-1.735z"/></svg></div>
          <div class="under-txt u-size" data-size>23 MB</div>
          <div class="under-txt2 u-rate" data-rate>4.4</div>
          <div class="icon-wrap share" title="Ø§Ø´ØªØ±Ø§Ú©â€ŒÚ¯Ø°Ø§Ø±ÛŒ"><svg viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7a3.28 3.28 0 000-1.39l7.05-4.11A2.99 2.99 0 0018 7.91c1.66 0 3-1.34 3-3S19.66 2 18 2s-3 1.34-3 3c0 .23.03.45.08.66L7.91 9.77A2.99 2.99 0 006 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.73 0 1.4-.26 1.91-.69l7.21 4.2c-.05.2-.08.41-.08.63A3 3 0 1018 16.08z"/></svg></div>
          <div class="icon-wrap buy" title="Ø®Ø±ÛŒØ¯"><svg viewBox="0 0 24 24"><path d="M7 4H5L4 6H0v2h2l3.6 7.59c-.35.59-.6 1.27-.6 2.01A3.5 3.5 0 008.5 21c1.61 0 2.96-1.07 3.36-2.5h2.28A3.5 3.5 0 0017.5 21 3.5 3.5 0 0021 17.5c0-1.23-.66-2.29-1.64-2.86l1.66-7.64H7V4zm0 4h11.1l-1.25 5.75H8.53L7 8z"/></svg></div>
          <div class="icon-wrap cmt" title="Ù†Ø¸Ø±Ø§Øª"><svg viewBox="0 0 24 24"><path d="M20 2H4a2 2 0 00-2 2v18l4-4h14a2 2 0 002-2V4a2 2 0 00-2-2z"/></svg></div>
          <div class="under-txt3 u-cmt" data-cmt>0</div>
        </div>
        <span class="title">Ø´Ø¨ Ø§Ù…ØªØ­Ø§Ù† â€“ Ø®ÛŒÙ„ÛŒ Ø³Ø¨Ø² <span class="dcount" data-dlc>(0 Ø¯Ø§Ù†Ù„ÙˆØ¯)</span></span>
        <div class="star-tip"></div>
      </div>
    </li>
  </ul>
</section>

<!-- Panel: Ø¯Ù‡Ù… -->
<section class="panel" data-panel="10">
  <h2>Ú©ØªØ§Ø¨â€ŒÙ‡Ø§ÛŒ Ø¬ØºØ±Ø§ÙÛŒØ§ØŒ Ù¾Ø§ÛŒÙ‡ Ø¯Ù‡Ù…</h2>
  <ul class="books" id="list10">
    <li data-id="geo10-shab">
      <div class="book-card" data-href="https://s32.picofile.com/file/8481978634/%D8%AC%D8%BA%D8%B1%D8%A7%D9%81%DB%8C%D8%A7_%D8%AF%D9%87%D9%85%D8%8C_%D8%B4%D8%A8_%D8%A7%D9%85%D8%AA%D8%AD%D8%A7%D9%86_B_U_L.pdf.html">
        <div class="left-acts">
          <div class="icon-wrap dl" title="Ø¯Ø§Ù†Ù„ÙˆØ¯"><svg viewBox="0 0 24 24"><path d="M12 16l4-5h-3V4h-2v7H8l4 5zm8 2H4v2h16v-2z"/></svg></div>
          <div class="icon-wrap star" title="Ø§Ù…ØªÛŒØ§Ø²"><svg viewBox="0 0 24 24"><path d="M12 .587l3.668 7.431L24 9.753l-6 5.847 1.416 8.263L12 19.771 4.584 23.863 6 15.6 0 9.753l8.332-1.735z"/></svg></div>
          <div class="under-txt u-size" data-size>24 MB</div>
          <div class="under-txt2 u-rate" data-rate>4.5</div>
          <div class="icon-wrap share" title="Ø§Ø´ØªØ±Ø§Ú©â€ŒÚ¯Ø°Ø§Ø±ÛŒ"><svg viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7a3.28 3.28 0 000-1.39l7.05-4.11A2.99 2.99 0 0018 7.91c1.66 0 3-1.34 3-3S19.66 2 18 2s-3 1.34-3 3c0 .23.03.45.08.66L7.91 9.77A2.99 2.99 0 006 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.73 0 1.4-.26 1.91-.69l7.21 4.2c-.05.2-.08.41-.08.63A3 3 0 1018 16.08z"/></svg></div>
          <div class="icon-wrap buy" title="Ø®Ø±ÛŒØ¯"><svg viewBox="0 0 24 24"><path d="M7 4H5L4 6H0v2h2l3.6 7.59c-.35.59-.6 1.27-.6 2.01A3.5 3.5 0 008.5 21c1.61 0 2.96-1.07 3.36-2.5h2.28A3.5 3.5 0 0017.5 21 3.5 3.5 0 0021 17.5c0-1.23-.66-2.29-1.64-2.86l1.66-7.64H7V4zm0 4h11.1l-1.25 5.75H8.53L7 8z"/></svg></div>
          <div class="icon-wrap cmt" title="Ù†Ø¸Ø±Ø§Øª"><svg viewBox="0 0 24 24"><path d="M20 2H4a2 2 0 00-2 2v18l4-4h14a2 2 0 002-2V4a2 2 0 00-2-2z"/></svg></div>
          <div class="under-txt3 u-cmt" data-cmt>0</div>
        </div>
        <span class="title">Ø´Ø¨ Ø§Ù…ØªØ­Ø§Ù† â€“ Ø®ÛŒÙ„ÛŒ Ø³Ø¨Ø² <span class="dcount" data-dlc>(0 Ø¯Ø§Ù†Ù„ÙˆØ¯)</span></span>
        <div class="star-tip"></div>
      </div>
    </li>

    <li data-id="geo10-dars">
      <div class="book-card" data-href="https://s32.picofile.com/file/8481961634/%D8%AF%D8%B1%D8%B3%D9%86%D8%A7%D9%85%D9%87_%D8%AC%D8%BA%D8%B1%D8%A7%D9%81%DB%8C%D8%A7_%D8%AF%D9%87%D9%85_%D8%A8%D8%B1_%D8%B9%D9%85%D8%B1_%D9%84%D8%B9%D9%86%D8%AA.pdf.html">
        <div class="left-acts">
          <div class="icon-wrap dl" title="Ø¯Ø§Ù†Ù„ÙˆØ¯"><svg viewBox="0 0 24 24"><path d="M12 16l4-5h-3V4h-2v7H8l4 5zm8 2H4v2h16v-2z"/></svg></div>
          <div class="icon-wrap star" title="Ø§Ù…ØªÛŒØ§Ø²"><svg viewBox="0 0 24 24"><path d="M12 .587l3.668 7.431L24 9.753l-6 5.847 1.416 8.263L12 19.771 4.584 23.863 6 15.6 0 9.753l8.332-1.735z"/></svg></div>
          <div class="under-txt u-size" data-size>36 MB</div>
          <div class="under-txt2 u-rate" data-rate>4.2</div>
          <div class="icon-wrap share" title="Ø§Ø´ØªØ±Ø§Ú©â€ŒÚ¯Ø°Ø§Ø±ÛŒ"><svg viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7a3.28 3.28 0 000-1.39l7.05-4.11A2.99 2.99 0 0018 7.91c1.66 0 3-1.34 3-3S19.66 2 18 2s-3 1.34-3 3c0 .23.03.45.08.66L7.91 9.77A2.99 2.99 0 006 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.73 0 1.4-.26 1.91-.69l7.21 4.2c-.05.2-.08.41-.08.63A3 3 0 1018 16.08z"/></svg></div>
          <div class="icon-wrap buy" title="Ø®Ø±ÛŒØ¯"><svg viewBox="0 0 24 24"><path d="M7 4H5L4 6H0v2h2l3.6 7.59c-.35.59-.6 1.27-.6 2.01A3.5 3.5 0 008.5 21c1.61 0 2.96-1.07 3.36-2.5h2.28A3.5 3.5 0 0017.5 21 3.5 3.5 0 0021 17.5c0-1.23-.66-2.29-1.64-2.86l1.66-7.64H7V4zm0 4h11.1l-1.25 5.75H8.53L7 8z"/></svg></div>
          <div class="icon-wrap cmt" title="Ù†Ø¸Ø±Ø§Øª"><svg viewBox="0 0 24 24"><path d="M20 2H4a2 2 0 00-2 2v18l4-4h14a2 2 0 002-2V4a2 2 0 00-2-2z"/></svg></div>
          <div class="under-txt3 u-cmt" data-cmt>0</div>
        </div>
        <span class="title">Ø¯Ø±Ø³Ù†Ø§Ù…Ù‡ Ø¬ØºØ±Ø§ÙÛŒØ§ â€“ Ø®ÛŒÙ„ÛŒ Ø³Ø¨Ø² <span class="dcount" data-dlc>(0 Ø¯Ø§Ù†Ù„ÙˆØ¯)</span></span>
        <div class="star-tip"></div>
      </div>
    </li>
  </ul>
</section>

<div style="text-align:center"><a class="btn-back" href="index.html">Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ù…Ù†ÙˆÛŒ Ø§ØµÙ„ÛŒ</a></div>
<div id="counter"><span id="visit-count">Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ...</span></div>

<!-- Preview modal -->
<div class="modal" id="previewModal"><div class="box"><h3 id="pvTitle">Ù¾ÛŒØ´â€ŒÙ†Ù…Ø§ÛŒØ´</h3><div id="pvBody" style="line-height:1.9;font-size:14.5px;opacity:.95"></div><div class="row"><button id="pvClose" class="btn gray">Ø¨Ø³ØªÙ†</button></div></div></div>

<!-- Sort modal -->
<div class="modal-sort" id="sortModal"><div class="box"><div class="sort-title">Ù…Ø±ØªØ¨â€ŒØ³Ø§Ø²ÛŒ Ø¨Ø± Ø§Ø³Ø§Ø³</div><ul class="sort-list" id="sortList"><li data-sort="default" class="active">Ù¾ÛŒØ´â€ŒÙØ±Ø¶</li><li data-sort="rate">Ø¨ÛŒØ´ØªØ±ÛŒÙ† Ø§Ù…ØªÛŒØ§Ø²</li><li data-sort="downloads">Ø¨ÛŒØ´ØªØ±ÛŒÙ† Ø¯Ø§Ù†Ù„ÙˆØ¯</li><li data-sort="size">Ú©Ù…â€ŒØ­Ø¬Ù…â€ŒØªØ±ÛŒÙ†</li></ul><div class="row"><button class="btn gray" id="btnSortClose">Ø¨Ø³ØªÙ†</button></div></div></div>

<!-- Comments modal -->
<div class="modal-cmt" id="cmtModal">
  <div class="box">
    <div class="cmt-title" id="cmtTitle"></div>
    <ul class="cmt-list" id="cmtList"></ul>
    <div class="cmt-foot">
      <textarea id="cmtInput" placeholder="Ú©Ø§Ù…Ù†Øª Ø¬Ø¯ÛŒØ¯"></textarea>
      <button class="btn" id="btnSendCmt">Ø§Ø±Ø³Ø§Ù„ Ú©Ø§Ù…Ù†Øª</button>
      <button class="btn gray" id="btnCloseCmt">Ø¨Ø³ØªÙ†</button>
    </div>
    <div class="note">Ø¨Ø±Ø§ÛŒ Ù‡Ø± Ú©ØªØ§Ø¨ Ø­Ø¯Ø§Ú©Ø«Ø± Û³ Ú©Ø§Ù…Ù†ØªÙ Ø§ØµÙ„ÛŒ Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ø«Ø¨Øª Ú©Ù†ÛŒØ¯ (Ù¾Ø§Ø³Ø®â€ŒÙ‡Ø§ Ù†Ø§Ù…Ø­Ø¯ÙˆØ¯ Ù‡Ø³ØªÙ†Ø¯).</div>
  </div>
</div>

<script>
  /* ---------- visits counter ---------- */
  async function loadVisits(){
    const slug='geography';
    try{
      const r=await fetch(`/api/visits?slug=${encodeURIComponent(slug)}`,{cache:'no-store'});
      const d=await r.json();
      if(!r.ok||typeof d.value!=='number')throw 0;
      document.getElementById('visit-count').textContent=`Ø¨Ø§Ø²Ø¯ÛŒØ¯ Ø§ÛŒÙ† ØµÙØ­Ù‡: ${d.value}`;
      await fetch(`/api/log?slug=${encodeURIComponent(slug)}`,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({ua:navigator.userAgent})});
    }catch{
      document.getElementById('visit-count').textContent='Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª Ø´Ù…Ø§Ø±Ù†Ø¯Ù‡';
    }
  }
  loadVisits();

  /* ---------- helpers ---------- */
  const devId=(localStorage.getItem('device_id')||(()=>{const v='dvc_'+Math.random().toString(36).slice(2);localStorage.setItem('device_id',v);return v})());
  function lsGet(k,d){try{return JSON.parse(localStorage.getItem(k))??d}catch{return d}}
  function lsSet(k,v){localStorage.setItem(k,JSON.stringify(v))}
  const bookMeta={
    'geo11-test':{size:'88 MB',rate:null,votes:null,buy:'https://www.digikala.com/product/dkp-9512809/Ú©ØªØ§Ø¨-Ù¾Ø±Ø³Ø´-Ù‡Ø§ÛŒ-Ú†Ù‡Ø§Ø±Ú¯Ø²ÛŒÙ†Ù‡-Ø§ÛŒ-Ø¬ØºØ±Ø§ÙÛŒØ§-2-Ø§Ø«Ø±-Ø²Ù‡Ø±Ø§-Ù†Ø¹Ù…ØªÛŒ-Ùˆ-Ø§Ù„Ù‡Ù‡-Ù‡Ù…Ø§ÛŒÙˆÙ†-Ø²Ø§Ø¯Ù‡-Ø§Ù†ØªØ´Ø§Ø±Ø§Øª-Ø®ÛŒÙ„ÛŒ-Ø³Ø¨Ø²/'},
    'geo11-shab':{size:'23 MB',rate:4.4,votes:26,buy:'https://www.digikala.com/product/dkp-820916/Ú©ØªØ§Ø¨-Ø´Ø¨-Ø§Ù…ØªØ­Ø§Ù†-Ø¬ØºØ±Ø§ÙÛŒØ§-Ù¾Ø§ÛŒÙ‡-ÛŒØ§Ø²Ø¯Ù‡Ù…-Ø§Ø«Ø±-Ø³ÛŒØ¯Ù‡-Ù…Ø±ÛŒÙ…-Ø·Ø§Ù‡Ø±ÛŒ/'},
    'geo10-shab':{size:'24 MB',rate:4.5,votes:67,buy:'https://www.digikala.com/product/dkp-4123378/Ú©ØªØ§Ø¨-Ø´Ø¨-Ø§Ù…ØªØ­Ø§Ù†-Ø¬ØºØ±Ø§ÙÛŒØ§-Ø§ÛŒØ±Ø§Ù†-Ø¯Ù‡Ù…-Ø§Ø«Ø±-Ù…Ù‡Ø¯ÛŒ-Ú©Ø§Ø±Ø¯Ø§Ù†-Ùˆ-Ø´Ø§Ø¯ÛŒ-Ú©Ø§Ø±ÛŒØ§Ù†-Ø§Ù†ØªØ´Ø§Ø±Ø§Øª-Ø®ÛŒÙ„ÛŒ-Ø³Ø¨Ø²/'},
    'geo10-dars':{size:'36 MB',rate:4.2,votes:45,buy:'https://www.digikala.com/product/dkp-1874006/Ú©ØªØ§Ø¨-Ù¾Ø±Ø³Ø´-Ù‡Ø§ÛŒ-Ú†Ù‡Ø§Ø±-Ú¯Ø²ÛŒÙ†Ù‡-Ø§ÛŒ-Ø¬ØºØ±Ø§ÙÛŒØ§-Ø¬Ø§Ù…Ø¹-Ø¯Ù‡Ù…-Ùˆ-ÛŒØ§Ø²Ø¯Ù‡Ù…-Ùˆ-Ø¯ÙˆØ§Ø²Ø¯Ù‡Ù…-Ø±Ø´ØªÙ‡-Ø§Ù†Ø³Ø§Ù†ÛŒ-Ø§Ø«Ø±-Ø²Ù‡Ø±Ø§-Ù†Ø¹Ù…ØªÛŒ-Ùˆ-Ø§Ù„Ù‡Ù‡-Ù‡Ù…Ø§ÛŒÙˆÙ†-Ø²Ø§Ø¯Ù‡-Ø§Ù†ØªØ´Ø§Ø±Ø§Øª-Ø®ÛŒÙ„ÛŒ-Ø³Ø¨Ø²/'}
  };

  /* ---------- API: downloads ---------- */
  async function getDownloads(book){try{const r=await fetch(`/api/downloads?book=${encodeURIComponent(book)}`,{cache:'no-store'});const d=await r.json();if(!r.ok||typeof d.value!=='number')throw 0;return d.value;}catch{return lsGet('dl_'+book,0)}}
  async function addDownload(book){try{const r=await fetch('/api/downloads',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({book,inc:1})});const d=await r.json();if(!r.ok||typeof d.value!=='number')throw 0;return d.value;}catch{const v=lsGet('dl_'+book,0)+1;lsSet('dl_'+book,v);return v;}}

  /* ---------- API: comments ---------- */
  async function apiGetComments(book){try{const r=await fetch(`/api/comments?book=${encodeURIComponent(book)}`,{cache:'no-store'});const d=await r.json();return d?.list||[]}catch{return[]}}
  async function apiPostComment(book,text,parentId){try{const r=await fetch('/api/comments',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({book,text,parentId:parentId||null,dev:devId})});const d=await r.json();return d;}catch{return{ok:false}}}

  /* ---------- search ---------- */
  const searchInput=document.getElementById('searchInput'),searchClear=document.getElementById('searchClear');
  function normalize(s){return (s||'').replace(/\s+/g,' ').toLowerCase()}
  function filterBooks(){const v=normalize(searchInput.value||'');document.querySelectorAll('.books li').forEach(li=>{const t=li.querySelector('.title').textContent;li.style.display=normalize(t).includes(v)?'':''});searchClear.style.display=v?'flex':'none'}
  searchInput.addEventListener('input',filterBooks);searchClear.addEventListener('click',()=>{searchInput.value='';filterBooks();searchInput.focus()})

  /* ---------- sort ---------- */
  const sortBtn=document.getElementById('btnSort'),sortModal=document.getElementById('sortModal'),sortList=document.getElementById('sortList'),sortClose=document.getElementById('btnSortClose');let currentSort='default';
  function openSort(){sortModal.style.display='flex';setTimeout(()=>sortModal.classList.add('show'),10)}function closeSort(){sortModal.classList.remove('show');setTimeout(()=>sortModal.style.display='none',160)}
  sortBtn.addEventListener('click',openSort);sortClose.addEventListener('click',closeSort);sortModal.addEventListener('click',e=>{if(e.target===sortModal)closeSort()});
  sortList.querySelectorAll('li').forEach(li=>{li.addEventListener('click',async()=>{sortList.querySelectorAll('li').forEach(x=>x.classList.remove('active'));li.classList.add('active');currentSort=li.dataset.sort;await applySort();sortBtn.textContent='Ù…Ø±ØªØ¨â€ŒØ³Ø§Ø²ÛŒ: '+li.textContent.trim();closeSort();})});
  async function applySort(){
    const items=[...document.querySelectorAll('.books li')].map(li=>{const id=li.dataset.id, meta=bookMeta[id]||{};const dlNum=parseInt((li.querySelector('[data-dlc]').textContent.match(/\d+/)||[0])[0],10)||0;return{li,id,size:meta.size?parseInt(meta.size):9999999,rate:(meta.rate==null?-1:meta.rate),downloads:dlNum};});
    switch(currentSort){case 'rate':items.sort((a,b)=>b.rate-a.rate);break;case 'downloads':items.sort((a,b)=>b.downloads-a.downloads);break;case 'size':items.sort((a,b)=>a.size-b.size);break;default:break;}
    const list11=document.getElementById('list11'),list10=document.getElementById('list10');items.forEach(it=>{const p=it.li.closest('.panel');if(p.dataset.panel==='11')list11.appendChild(it.li);else list10.appendChild(it.li);});
  }

  /* ---------- preview --------- */
  const pvModal=document.getElementById('previewModal'),pvTitle=document.getElementById('pvTitle'),pvBody=document.getElementById('pvBody'),pvClose=document.getElementById('pvClose');
  pvClose.addEventListener('click',()=>{pvModal.classList.remove('show');setTimeout(()=>pvModal.style.display='none',180)});pvModal.addEventListener('click',e=>{if(e.target===pvModal)pvClose.click()});
  function openPreview(card,id){const title=card.querySelector('.title').textContent.replace(/\(\d+ Ø¯Ø§Ù†Ù„ÙˆØ¯\)/,'').trim();const href=card.dataset.href;const meta=bookMeta[id]||{};pvTitle.textContent='Ù¾ÛŒØ´â€ŒÙ†Ù…Ø§ÛŒØ´ Â«'+title+'Â»';pvBody.innerHTML=`<div>Ø­Ø¬Ù… ÙØ§ÛŒÙ„: <b>${meta.size||'Ù†Ø§Ù…Ø´Ø®Øµ'}</b></div><div>Ù„ÛŒÙ†Ú© Ø¯Ø§Ù†Ù„ÙˆØ¯: ${href?`<a href="${href}" target="_blank" rel="noopener" style="color:#aef">Ø¨Ø§Ø² Ú©Ø±Ø¯Ù†</a>`:'Ù†Ø§Ù…Ø´Ø®Øµ'}</div><div>Ø§Ù…ØªÛŒØ§Ø² Ø¯ÛŒØ¬ÛŒâ€ŒÚ©Ø§Ù„Ø§: <b>${meta.rate==null?'Ù†Ø§Ù…ÙˆØ¬ÙˆØ¯':meta.rate}</b> ${meta.votes?`(Ø§Ø² ${meta.votes} Ø±Ø£ÛŒ)`:''}</div><div style="margin-top:6px">Ø®Ø±ÛŒØ¯: ${meta.buy?`<a href="${meta.buy}" target="_blank" rel="noopener" style="color:#aef">Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ø¯Ø± Ø¯ÛŒØ¬ÛŒâ€ŒÚ©Ø§Ù„Ø§</a>`:'â€”'}</div>`;pvModal.style.display='flex';setTimeout(()=>pvModal.classList.add('show'),10)}

  /* ---------- comments modal ---------- */
  const cmtModal=document.getElementById('cmtModal'),cmtList=document.getElementById('cmtList'),cmtTitle=document.getElementById('cmtTitle'),cmtInput=document.getElementById('cmtInput'),btnSendCmt=document.getElementById('btnSendCmt'),btnCloseCmt=document.getElementById('btnCloseCmt');
  let currentBook=null,lastCommentsCache=[];
  function openCmtModal(bookId,title){currentBook=bookId;cmtTitle.textContent='Ú©Ø§Ù…Ù†Øªâ€ŒÙ‡Ø§ÛŒ '+title; cmtInput.value=''; cmtModal.style.display='flex'; setTimeout(()=>cmtModal.classList.add('show'),10); loadAndRenderComments();}
  function closeCmtModal(){cmtModal.classList.remove('show');setTimeout(()=>cmtModal.style.display='none',180)}
  btnCloseCmt.addEventListener('click',closeCmtModal);cmtModal.addEventListener('click',e=>{if(e.target===cmtModal)closeCmtModal()});
  function formatTS(ts){const d=new Date(ts||0);if(isNaN(d))return'';return d.toLocaleString('fa-IR',{hour12:false});}
  function renderComments(list){
    lastCommentsCache=list.slice();
    const hidden=lsGet('hide_'+currentBook,[]);
    cmtList.innerHTML='';
    list.forEach(c=>{
      if(hidden.includes(c.id)) return;
      const li=document.createElement('li');li.className='cmt-item';
      const head=document.createElement('div');head.className='cmt-head';head.textContent=`Ú©Ø§Ø±Ø¨Ø± Ù†Ø§Ø´Ù†Ø§Ø³ â€¢ ${formatTS(c.ts)}`;
      const text=document.createElement('div');text.className='cmt-text';text.textContent=c.text||c.content||'';
      const actions=document.createElement('div');actions.className='cmt-actions';
      const replyBtn=document.createElement('button');replyBtn.className='btn mini';replyBtn.textContent='Ù¾Ø§Ø³Ø®';actions.appendChild(replyBtn);
      if(c.dev===devId){const del=document.createElement('button');del.className='btn gray mini';del.textContent='Ø­Ø°Ù';del.addEventListener('click',()=>{const arr=lsGet('hide_'+currentBook,[]);if(!arr.includes(c.id)){arr.push(c.id);lsSet('hide_'+currentBook,arr);}renderComments(lastCommentsCache)});actions.appendChild(del);}
      li.appendChild(head);li.appendChild(text);li.appendChild(actions);

      // replies
      const repWrap=document.createElement('div');repWrap.className='reply-list';
      (c.replies||[]).forEach(rp=>{
        const rpEl=document.createElement('div');rpEl.className='cmt-item';rpEl.style.margin='6px 0';rpEl.innerHTML=`<div class="cmt-head">Ú©Ø§Ø±Ø¨Ø± Ù†Ø§Ø´Ù†Ø§Ø³ â€¢ ${formatTS(rp.ts)}</div><div class="cmt-text">${rp.text?rp.text.replace(/</g,'&lt;'):' '}</div>`;
        repWrap.appendChild(rpEl);
      });
      li.appendChild(repWrap);

      // reply editor
      const repEdit=document.createElement('div');repEdit.style.display='none';repEdit.style.marginTop='8px';repEdit.innerHTML=`<textarea style="width:100%;min-height:60px;border:none;border-radius:8px;padding:8px;background:rgba(255,255,255,.9);color:#111;font-family:inherit"></textarea><div style="margin-top:6px;display:flex;gap:6px;justify-content:flex-end"><button class="btn mini">Ø§Ø±Ø³Ø§Ù„ Ù¾Ø§Ø³Ø®</button><button class="btn gray mini">Ø§Ù†ØµØ±Ø§Ù</button></div>`;
      li.appendChild(repEdit);
      replyBtn.addEventListener('click',()=>{repEdit.style.display='block';repEdit.querySelector('textarea').focus()});
      repEdit.querySelector('.btn.gray').addEventListener('click',()=>{repEdit.style.display='none'});
      repEdit.querySelector('.btn').addEventListener('click',async()=>{
        const v=repEdit.querySelector('textarea').value.trim(); if(!v) return;
        const r=await apiPostComment(currentBook,v,c.id); if(r && r.ok){repEdit.querySelector('textarea').value=''; repEdit.style.display='none'; loadAndRenderComments();}
      });

      cmtList.appendChild(li);
    });
  }
  async function loadAndRenderComments(){
    const list=await apiGetComments(currentBook); // array
    renderComments(list);
    // update comment count under icon
    const el=document.querySelector(`li[data-id="${currentBook}"] [data-cmt]`); if(el) el.textContent=list.length;
  }
  btnSendCmt.addEventListener('click',async()=>{
    if(!currentBook) return;
    const txt=cmtInput.value.trim(); if(!txt) return;
    // limit 3 main comments per device
    const myCount=(lastCommentsCache.filter(x=>x.dev===devId && !x.parentId).length)||0;
    if(myCount>=3){alert('Ø­Ø¯Ø§Ú©Ø«Ø± Û³ Ú©Ø§Ù…Ù†Øª Ø§ØµÙ„ÛŒ Ù…Ø¬Ø§Ø² Ø§Ø³Øª'); return;}
    const r=await apiPostComment(currentBook,txt,null); if(r && r.ok){cmtInput.value=''; loadAndRenderComments();}
  });

  /* ---------- cards ---------- */
  function initCards(){
    document.querySelectorAll('.book-card').forEach(card=>{
      const li=card.closest('li');const id=li.dataset.id;const countEl=card.querySelector('[data-dlc]');const starTip=card.querySelector('.star-tip');const meta=bookMeta[id]||{};
      // load download count & comments count
      getDownloads(id).then(v=>{countEl.textContent=`(${v} Ø¯Ø§Ù†Ù„ÙˆØ¯)`});
      apiGetComments(id).then(list=>{const el=card.querySelector('[data-cmt]');if(el)el.textContent=list.length||0});

      // star tip
      card.querySelector('.icon-wrap.star').addEventListener('click',e=>{
        e.stopPropagation();let msg=(meta.rate==null)?'Ø¨Ø±Ø§ÛŒ Ø§ÛŒÙ† Ú©ØªØ§Ø¨ Ø§Ù…ØªÛŒØ§Ø²ÛŒ Ø¯Ø± Ø¯ÛŒØ¬ÛŒâ€ŒÚ©Ø§Ù„Ø§ Ø«Ø¨Øª Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª':`${meta.rate} Ø§Ø² 5 Ø¨Ø± Ø§Ø³Ø§Ø³ ${meta.votes} Ø±Ø£ÛŒ Ø«Ø¨Øªâ€ŒØ´Ø¯Ù‡ Ø¯Ø± Ø¯ÛŒØ¬ÛŒâ€ŒÚ©Ø§Ù„Ø§`;starTip.textContent=msg;starTip.classList.remove('hide');starTip.classList.add('show');setTimeout(()=>{starTip.classList.remove('show');starTip.classList.add('hide')},6000);
      });
      // buy
      card.querySelector('.icon-wrap.buy').addEventListener('click',e=>{e.stopPropagation();if(meta.buy)window.open(meta.buy,'_blank','noopener')});
      // share
      card.querySelector('.icon-wrap.share').addEventListener('click',async e=>{e.stopPropagation();const t=card.querySelector('.title').textContent.replace(/\(\d+ Ø¯Ø§Ù†Ù„ÙˆØ¯\)/,'').trim();const url=location.href;if(navigator.share){try{await navigator.share({title:t,text:'Ú©ØªØ§Ø¨ Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ÛŒ:',url});}catch{}}else{try{await navigator.clipboard.writeText(`${t}\n${url}`);alert('Ù„ÛŒÙ†Ú© ØµÙØ­Ù‡ Ú©Ù¾ÛŒ Ø´Ø¯')}catch{alert('Ú©Ù¾ÛŒ Ù†Ø´Ø¯Ø› Ø¯Ø³ØªÛŒ Ú©Ù¾ÛŒ Ú©Ù†ÛŒØ¯.')}}});
      // download
      card.querySelector('.icon-wrap.dl').addEventListener('click',async e=>{e.stopPropagation();const nv=await addDownload(id);countEl.textContent=`(${nv} Ø¯Ø§Ù†Ù„ÙˆØ¯)`;const href=card.dataset.href;if(href)window.open(href,'_blank','noopener')});
      // comments
      const cbtn=card.querySelector('.icon-wrap.cmt'); if(cbtn){ cbtn.addEventListener('click',e=>{e.stopPropagation(); const t=card.querySelector('.title').textContent.replace(/\(\d+ Ø¯Ø§Ù†Ù„ÙˆØ¯\)/,'').trim();openCmtModal(id,t) });}
      // click body -> preview
      card.addEventListener('click',()=>openPreview(card,id));
    });
  }
  initCards();
</script>
</body>
</html>
